package com.arceuusSpellbookReminder;

import net.runelite.client.config.Config;
import net.runelite.client.config.ConfigGroup;
import net.runelite.client.config.ConfigItem;

import java.awt.Color;

@ConfigGroup("arceuusreminder")
public interface ReminderConfig extends Config
{
    enum ReminderStyle
    {
        LONG_TEXT,
        SHORT_TEXT,
        CUSTOM_TEXT
    }

    @ConfigItem(
            keyName = "color",
            name = "Overlay Color",
            description = "Color of the reminder overlay background"
    )
    default Color color()
    {
        return new Color(0, 102, 204, 150); // semi-transparent blue
    }

    @ConfigItem(
            keyName = "reminderStyle",
            name = "Text Style",
            description = "Choose between long or short reminder text"
    )
    default ReminderStyle reminderStyle()
    {
        return ReminderStyle.LONG_TEXT;
    }

    @ConfigItem(
            keyName = "customText",
            name = "Custom Reminder Text",
            description = "Text to display if you select the 'Custom Text' style"
    )
    default String customText()
    {
        return "SWTICH TO ARCEUUS!";
    }

    @ConfigItem(
            keyName = "ignoreClues",
            name = "Ignore if carrying clues and caskets",
            description = "Do not show reminder when you have any clue scroll or casket in inventory"
    )
    default boolean ignoreClues()
    {
        return true;
    }
}

package com.arceuusSpellbookReminder;

import java.awt.Dimension;
import java.awt.Graphics2D;
import javax.inject.Inject;

import net.runelite.api.Client;
import net.runelite.client.ui.overlay.OverlayPanel;
import net.runelite.client.ui.overlay.OverlayPosition;
import net.runelite.client.ui.overlay.components.LineComponent;

public class ReminderOverlay extends OverlayPanel
{
    private static final String LONG_TEXT = "SWITCH TO ARCEUUS SPELLBOOK!";
    private static final String SHORT_TEXT = "ARCEUUS!";

    private final ReminderPlugin plugin;
    private final ReminderConfig config;
    private final Client client;

    @Inject
    public ReminderOverlay(ReminderPlugin plugin, ReminderConfig config, Client client)
    {
        this.plugin = plugin;
        this.config = config;
        this.client = client;

        setPosition(OverlayPosition.ABOVE_CHATBOX_RIGHT);
    }

    @Override
    public Dimension render(Graphics2D graphics)
    {
        if (panelComponent == null)
        {
            return null;
        }

        // Clear existing text
        panelComponent.getChildren().clear();

        // Only show reminder if player has the Book of the Dead and is not on Arceuus
        if (plugin.hasBookOfTheDead() && !plugin.isOnArceuusSpellbook())
        {
            if (config.ignoreClues() && plugin.hasClueScroll()){
                return null;
            }
            panelComponent.setBackgroundColor(config.color());

            switch (config.reminderStyle())
            {
                case LONG_TEXT:
                    panelComponent.getChildren().add(LineComponent.builder()
                            .left(LONG_TEXT)
                            .build());
                    panelComponent.setPreferredSize(
                            new Dimension(graphics.getFontMetrics().stringWidth(LONG_TEXT) + 8, 0)
                    );
                    break;

                case SHORT_TEXT:
                    panelComponent.getChildren().add(LineComponent.builder()
                            .left(SHORT_TEXT)
                            .build());
                    panelComponent.setPreferredSize(
                            new Dimension(graphics.getFontMetrics().stringWidth(SHORT_TEXT) + 8, 0)
                    );
                    break;

                case CUSTOM_TEXT:
                    String custom = config.customText();
                    if (custom == null || custom.trim().isEmpty())
                    {
                        custom = LONG_TEXT; // fallback if blank
                    }
                    panelComponent.getChildren().add(LineComponent.builder()
                            .left(custom)
                            .build());
                    panelComponent.setPreferredSize(
                            new Dimension(graphics.getFontMetrics().stringWidth(custom) + 8, 0)
                    );
                    break;
            }

            return panelComponent.render(graphics);
        }

        return null;
    }
}

package com.arceuusSpellbookReminder;

import javax.inject.Inject;

import com.google.inject.Provides;
import net.runelite.api.Client;
import net.runelite.api.Item;
import net.runelite.api.ItemContainer;
import net.runelite.api.gameval.InventoryID;
import net.runelite.api.gameval.ItemID;
import net.runelite.api.gameval.VarbitID;
import net.runelite.client.config.ConfigManager;
import net.runelite.client.plugins.Plugin;
import net.runelite.client.plugins.PluginDescriptor;
import net.runelite.client.ui.overlay.OverlayManager;

@PluginDescriptor(
        name = "Arceuus Spellbook Reminder"
)
public class ReminderPlugin extends Plugin
{
    private static final int BOOK_OF_THE_DEAD = ItemID.BOOK_OF_THE_DEAD;
    private static final int ARCEUUS_SPELLBOOK_ID = 3;

    @Inject
    private Client client;

    @Inject
    private OverlayManager overlayManager;

    @Inject
    private ReminderConfig config;

    @Inject
    private ReminderOverlay overlay;

    @Provides
    ReminderConfig provideConfig(ConfigManager configManager)
    {
        return configManager.getConfig(ReminderConfig.class);
    }

    @Override
    protected void startUp()
    {
        overlayManager.add(overlay);
    }

    @Override
    protected void shutDown()
    {
        overlayManager.remove(overlay);
    }

    public boolean hasBookOfTheDead()
    {
        final ItemContainer inventory = client.getItemContainer(InventoryID.INV);
        if (inventory == null)
        {
            return false;
        }
        return inventory.contains(BOOK_OF_THE_DEAD);
    }

    public boolean isOnArceuusSpellbook()
    {
        return client.getVarbitValue(VarbitID.SPELLBOOK) == ARCEUUS_SPELLBOOK_ID;
    }

    public boolean hasClueScroll()
    {
        final ItemContainer inventory = client.getItemContainer(InventoryID.INV);
        if (inventory == null)
        {
            return false;
        }

        for (Item item : inventory.getItems())
        {
            if (item == null)
            {
                continue;
            }

            String name = client.getItemDefinition(item.getId()).getName().toLowerCase();

            if (name.contains("clue scroll") || name.contains("reward casket"))
            {
                return true;
            }
        }
        return false;
    }


}

package com.arceuusSpellbookReminder;

import net.runelite.client.RuneLite;
import net.runelite.client.externalplugins.ExternalPluginManager;

public class ReminderPluginTest
{
	public static void main(String[] args) throws Exception
	{
		ExternalPluginManager.loadBuiltin(ReminderPlugin.class);
		RuneLite.main(args);
	}
}
