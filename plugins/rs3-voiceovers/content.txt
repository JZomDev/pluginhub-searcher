package com.rs3voiceovers;

public enum AmascutP3 {
    ZEBAK_BABA("Crondis/Apmeken"),
    AKKHA_KEPHRI("Het/Scabaras");

    AmascutP3(String option) {
        this.option = option;
    }

    private final String option;

    public String getOption() {
        return this.option;
    }

    public String toString() {
        return this.option;
    }
}

package com.rs3voiceovers.animation;


import lombok.Getter;

public enum CustomAnimation {
    // Zuk
    ZUK_IDLE(7564),
    ZUK_ATTACK(7566),

    // Zemouregal
    ZEMOUREGAL_IDLE(9874),
    ZEMOUREGAL_WALK_1(9875),
    ZEMOUREGAL_WALK_2(9876),
    ZEMOUREGAL_CAST_1(9879),
    ZEMOUREGAL_CAST_2(9878),
    ZEMOUREGAL_CAST_3(9877),
    ZEMOUREGAL_CAST_4(9898),
    ZEMOUREGAL_CAST_5(10148),
    ZEMOUREGAL_CAST_6(10153),
    ZEMOUREGAL_SPAWN(9880),
    ZEMOUREGAL_DESPAWN(9872),

    // Amascut
    AMASCUT_SPAWN(11261),
    AMASCUT_IDLE_1(10169),
    AMASCUT_IDLE_2(11698),
    AMASCUT_WALK_1(10170),
    AMASCUT_DOWN_ENTER(10394),
    AMASCUT_DOWN(10395),
    AMASCUT_DOWN_EXIT(11131),
    AMASCUT_CAST_1(11424), // bend the knee
    AMASCUT_CAST_2(10676), // melee command
    AMASCUT_CAST_3(11133), // slow bow shot
    AMASCUT_CAST_4(11423), // mage command
    AMASCUT_CAST_5(10503), // sweep into handsup, like tele
    AMASCUT_CAST_6(10655), // raise hands then back down (use for spawns?)
    AMASCUT_CAST_7(11060), // raise hands then back down slower (use for spawns?)
    AMASCUT_CAST_8(9816), // destruction
    AMASCUT_CAST_9(11517), // arms out
    AMASCUT_CAST_10(11645),
    AMASCUT_HURT(10501),
    AMASCUT_TELEPORT_OUT(10543), // quick fade and up
    AMASCUT_TELEPORT_IN(10956), // quick fade and down
    AMASCUT_CHANNEL(11283),
    AMASCUT_DESPAWN(11315),
    AMASCUT_ENRAGE_1(11875),
    AMASCUT_ENRAGE_2(11876),
    AMASCUT_ENRAGE_3(11877),
    AMASCUT_ENRAGE_4(11878),

    ;

    @Getter
    private final int animationID;

    CustomAnimation(int animID) {
        animationID = animID;
    }


}

package com.rs3voiceovers.animation;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.*;
import net.runelite.api.coords.LocalPoint;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatColorType;
import net.runelite.client.chat.ChatMessageBuilder;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.chat.QueuedMessage;
import net.runelite.client.plugins.Plugin;

public class FakeNpcHandler extends Plugin {

    @Getter @Setter
    private int overheadTextTimer = 0;

    @Getter @Setter
    private Client client;
    @Getter @Setter
    private ChatMessageManager chatMessageManager;
    @Getter @Setter
    private RS3VoiceoversOverlay overlay;

    public boolean isOnFinalAnimationFrame(RuneLiteObject runeLiteObject) {
        if (runeLiteObject.getAnimationController().getAnimation() != null)
            return (runeLiteObject.getAnimationController().getAnimation().getNumFrames() - 1) == runeLiteObject.getAnimationController().getFrame();

        return false;
    }

    public void addOverheadText(RuneLiteObject runeLiteObject, String name, String overheadText) {
        String chatMessage = new ChatMessageBuilder()
                .append(ChatColorType.NORMAL)
                .append(overheadText)
                .build();
        overheadTextTimer = 5;
        if (overlay != null)
            overlay.setOverheadText(overheadText);
        chatMessageManager.queue(QueuedMessage.builder()
                .type(ChatMessageType.PUBLICCHAT)
                .name(name)
                .runeLiteFormattedMessage(chatMessage)
                .timestamp((int) (System.currentTimeMillis() / 1000))
                .build());
    }

    public void addOverheadText(RuneLiteObject runeLiteObject, String name, String overheadText, int ticksToRemoveOverheadText, boolean createChatMessage) {
        String chatMessage = new ChatMessageBuilder()
                .append(ChatColorType.NORMAL)
                .append(overheadText)
                .build();
        overheadTextTimer = ticksToRemoveOverheadText;
        if (overlay != null)
            overlay.setOverheadText(overheadText);
        if (createChatMessage) {
            chatMessageManager.queue(QueuedMessage.builder()
                    .type(ChatMessageType.PUBLICCHAT)
                    .name(name)
                    .runeLiteFormattedMessage(chatMessage)
                    .timestamp((int) (System.currentTimeMillis() / 1000))
                    .build());
        }
    }

    // I copied this from Zoinkwiz's questhelper plugin I hope that's fine
    public static Model createFakeNpcModel(Client client, int NpcID) {
        NPCComposition npc = client.getNpcDefinition(NpcID);
        int[] models = npc.getModels();
        short[] coloursToReplace = npc.getColorToReplace();
        short[] coloursToReplaceWith = npc.getColorToReplaceWith();
        ModelData mdf = createModel(client, models);

        if (coloursToReplace != null && coloursToReplaceWith != null && coloursToReplace.length == coloursToReplaceWith.length) {
            for (int i=0; i < coloursToReplace.length; i++)
            {
                mdf.recolor(coloursToReplace[i], coloursToReplaceWith[i]);
            }
        }
        return mdf.cloneColors()
                .light();
    }

    public static ModelData createModel(Client client, ModelData... data)
    {
        return client.mergeModels(data);
    }

    public static ModelData createModel(Client client, int... data)
    {
        ModelData[] modelData = new ModelData[data.length];
        for (int i = 0; i < data.length; i++)
        {
            modelData[i] = client.loadModelData(data[i]);
        }
        return client.mergeModels(modelData);
    }

    public RuneLiteObject createFakeNpc(int modelID, int animationID, int x, int y) {
        RuneLiteObject fakeNpc = new RuneLiteObject(client);
        fakeNpc.setModel(createFakeNpcModel(client, modelID));

        LocalPoint fakeNpcLocation = new LocalPoint(x, y, client.getLocalPlayer().getWorldView());
        fakeNpc.setLocation(fakeNpcLocation, client.getLocalPlayer().getWorldView().getPlane());

        AnimationController animations = new AnimationController(client, animationID);
        fakeNpc.setAnimationController(animations);
        overlay.setRuneLiteObject(fakeNpc);

        fakeNpc.setActive(true);

        return fakeNpc;
    }

    public void facePlayer(RuneLiteObject runeLiteObject) {
        if (runeLiteObject == null)
            return;

        int xDiff = runeLiteObject.getLocation().getX() - client.getLocalPlayer().getLocalLocation().getX();
        int yDiff = runeLiteObject.getLocation().getY() - client.getLocalPlayer().getLocalLocation().getY();

        double angle = Math.toDegrees(Math.atan2(xDiff, yDiff));
        if (angle < 0)
            angle += 360;

        int trueAngle = (int)(angle * 5.688888888888888);

        int rotation;
        int delta = trueAngle - runeLiteObject.getOrientation();
        if ((0 < delta && delta < 1024) || (-1024 > delta && delta > -2048)) {
            rotation = Math.min(20, Math.abs(delta));
        }
        else {
            rotation = Math.max(-20, delta);
        }

        int newOrientation = runeLiteObject.getOrientation() + rotation;
        if (newOrientation < 0)
            newOrientation += 2048;
        else if (newOrientation >= 2048)
            newOrientation -= 2048;

        runeLiteObject.setOrientation(newOrientation);
    }

    public void faceDirection(RuneLiteObject runeLiteObject, int direction) {
        if (runeLiteObject == null)
            return;

        int rotation;
        int delta = direction - runeLiteObject.getOrientation();
        if ((0 < delta && delta < 1024) || (-1024 > delta && delta > -2048)) {
            rotation = Math.min(20, Math.abs(delta));
        }
        else {
            rotation = Math.max(-20, delta);
        }

        int newOrientation = runeLiteObject.getOrientation() + rotation;
        if (newOrientation < 0)
            newOrientation += 2048;
        else if (newOrientation >= 2048)
            newOrientation -= 2048;

        runeLiteObject.setOrientation(newOrientation);
    }

    public void onGameTick(GameTick event) {
        if (overheadTextTimer > 0)
            overheadTextTimer--;
        else if (overlay != null)
            overlay.setOverheadText("");
    }
}

package com.rs3voiceovers.animation;


import lombok.Getter;

public enum Status {
    INACTIVE(0),

    // Zemouregal
    ZEMOUREGAL_START(1),
    ZEMOUREGAL_CAST(2),
    ZEMOUREGAL_IDLE(3),
    ZEMOUREGAL_TURN(4),
    ZEMOUREGAL_SPELL(5),
    ZEMOUREGAL_SPELL_WINDUP(6),
    ZEMOUREGAL_END(7),
    ZEMOUREGAL_DESPAWN(8),

    // Amascut
    AMASCUT_START(9),
    AMASCUT_IDLE(10),
    AMASCUT_TURN(11),
    AMASCUT_TELEPORT_OUT(12),
    AMASCUT_TELEPORT_IN(13),
    AMASCUT_CAST(14),
    AMASCUT_INTO_DOWN(15),
    AMASCUT_DOWN(16),
    AMASCUT_SUMMON_PHANTOM_1(17),
    AMASCUT_SUMMON_PHANTOM_2(18),
    AMASCUT_CHANNEL(19),
    AMASCUT_ENRAGE_1(20),
    AMASCUT_ENRAGE_2(21),
    AMASCUT_ENRAGE_3(22),
    AMASCUT_END(23),

    // Fake Zuk
    ZUK_IDLE(24),
    ZUK_ATTACK(25),

    ;

    @Getter
    private final int status;

    Status(int statusID) {
        status = statusID;
    }


}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.animation.CustomAnimation;
import com.rs3voiceovers.animation.FakeNpcHandler;
import com.rs3voiceovers.animation.Status;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.*;
import net.runelite.api.coords.LocalPoint;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatMessageManager;
import org.apache.commons.lang3.ArrayUtils;

import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Amascut implements Boss {
    private static final int WARDENS_ARENA_1 = 15184;
    private static final int WARDENS_ARENA_2 = 15696;

    @Getter @Setter
    private NPC boss;
    @Getter @Setter
    private RuneLiteObject amascut;
    @Getter @Setter
    private int amascutStatus = Status.INACTIVE.getStatus();
    @Getter @Setter
    private FakeNpcHandler fakeNpcHandler = new FakeNpcHandler();

    private int ticksSinceEncounterStart = -1;
    private int ticksSinceLastQuote = -1;
    private int antiSpam = 0;
    private int turnTimer = 0;
    private int messageDelay = -1;

    private int lastPhrase = -1;

    private int amascutMonologue = 0;
    private int amascutTeleportTimer = 0;
    private int phase = 0;
    @Getter @Setter
    private boolean tumekenP3 = true;
    private int projectileImpactTick = -1;
    private int specialProjectile = 0;


    private final Random random = new Random();

    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
        fakeNpcHandler.setClient(client);
        fakeNpcHandler.setChatMessageManager(chatMessageManager);
        fakeNpcHandler.setOverlay(overlay);
    }

    private boolean isInWardensArena() {
        return client.getMapRegions() != null && (ArrayUtils.contains(client.getMapRegions(), WARDENS_ARENA_1) ||
                ArrayUtils.contains(client.getMapRegions(), WARDENS_ARENA_2));
    }

    private void amascutTeleport() {
        if (++amascutTeleportTimer > 10 && amascutStatus != Status.AMASCUT_TELEPORT_OUT.getStatus()) {
            amascutStatus = Status.AMASCUT_TELEPORT_OUT.getStatus();
            setAnimation(CustomAnimation.AMASCUT_TELEPORT_OUT.getAnimationID());
        }
    }

    public void onChatMessage(ChatMessage event) {
        String message = event.getMessage();

        // Wardens start
        if (isInWardensArena()) {
            if (message.equals("Challenge started: The Wardens.")) {
                resetWardens();

                amascut = fakeNpcHandler.createFakeNpc(NpcID.AMASCUT_11696, CustomAnimation.AMASCUT_SPAWN.getAnimationID(), 6208, 6592);
                fakeNpcHandler.getOverlay().setMaxTextHeightOffset(380);
                fakeNpcHandler.getOverlay().setMinTextHeightOffset(320);
                amascut.setOrientation(1024);
                amascutStatus = Status.AMASCUT_START.getStatus();

                fakeNpcHandler.addOverheadText(amascut,"Amascut","Destruction. Annihilation. My vision for this world.", 10, true);
                soundEngine.playClip(Sound.AMASCUT_START_1, executor);
                amascutMonologue = 1;
                messageDelay = client.getTickCount() + 10;
                antiSpam = 45;
                phase = 1;
                ticksSinceEncounterStart = 0;
                ticksSinceLastQuote = 0;
            }

            Matcher matcher = Pattern.compile("Challenge complete: The Wardens.(.+?)").matcher(message);
            if (matcher.find() && amascut != null) {
                switch (random.nextInt(3)) {
                    case 0:
                        amascutChatMessage("Impossible...");
                        soundEngine.playClip(Sound.AMASCUT_VICTORY_1, executor);
                        break;
                    case 1:
                        amascutChatMessage("This cannot be the end...");
                        soundEngine.playClip(Sound.AMASCUT_VICTORY_2, executor);
                        break;
                    case 2:
                        amascutChatMessage("NO!");
                        soundEngine.playClip(Sound.AMASCUT_VICTORY_3, executor);
                        break;
                }
                amascutMonologue = -1;
                amascutStatus = Status.AMASCUT_END.getStatus();
                setAnimation(CustomAnimation.AMASCUT_DESPAWN.getAnimationID());
            }

            if (message.equals("Your party failed to complete the challenge. You may try again...") ||
                message.equals("You failed to survive the Tombs of Amascut.")) {

                if (amascut != null)
                    amascutChatMessage("Your souls are mine!");
                else
                    client.addChatMessage(ChatMessageType.PUBLICCHAT, "Amascut", "Your souls are mine!", null);

                soundEngine.playClip(Sound.AMASCUT_DEFEAT_3, executor);
                resetWardens();
            }
        }
    }

    public void onClientTick(ClientTick event) {
        if (turnTimer > 0)
            turnTimer--;

        // Amascut animations
        if (isInWardensArena() && amascut != null) {
            int oldOrientation = amascut.getOrientation();

            if (phase == 3) {
                if (amascutStatus == Status.AMASCUT_SUMMON_PHANTOM_1.getStatus())
                    fakeNpcHandler.faceDirection(amascut, 1280);
                else if (amascutStatus == Status.AMASCUT_SUMMON_PHANTOM_2.getStatus())
                    fakeNpcHandler.faceDirection(amascut, 640);
                else
                    fakeNpcHandler.faceDirection(amascut, 1024);
            }
            else if (amascutStatus != Status.AMASCUT_START.getStatus()) {
                fakeNpcHandler.facePlayer(amascut);
            }

            if ((amascutStatus == Status.AMASCUT_START.getStatus()              ||
                 amascutStatus == Status.AMASCUT_CAST.getStatus()               ||
                 amascutStatus == Status.AMASCUT_SUMMON_PHANTOM_2.getStatus()   ||
                 amascutStatus == Status.AMASCUT_TELEPORT_IN.getStatus())       && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {

                amascutStatus = Status.AMASCUT_IDLE.getStatus();

                if (phase == 3)
                    setAnimation(CustomAnimation.AMASCUT_IDLE_2.getAnimationID());
                else
                    setAnimation(CustomAnimation.AMASCUT_IDLE_1.getAnimationID());
            }

            if (amascutStatus == Status.AMASCUT_TELEPORT_OUT.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                amascutStatus = Status.AMASCUT_TELEPORT_IN.getStatus();
                setAnimation(CustomAnimation.AMASCUT_TELEPORT_IN.getAnimationID());

                LocalPoint fakeNpcLocation;

                if (client.getLocalPlayer().getLocalLocation().getX() > 6592)
                    fakeNpcLocation = new LocalPoint(7744, 6848, client.getLocalPlayer().getWorldView());
                else if (client.getLocalPlayer().getLocalLocation().getX() < 5696)
                    fakeNpcLocation = new LocalPoint(4672, 6848, client.getLocalPlayer().getWorldView());
                else if (client.getLocalPlayer().getLocalLocation().getY() < 6464)
                    fakeNpcLocation = new LocalPoint(6208, 6336, client.getLocalPlayer().getWorldView());
                else
                    fakeNpcLocation = new LocalPoint(6208, 6592, client.getLocalPlayer().getWorldView());

                amascutTeleportTimer = -20;
                amascut.setLocation(fakeNpcLocation, client.getLocalPlayer().getWorldArea().getPlane());

                if (fakeNpcLocation.getY() == 6848 && antiSpam == 0) {
                    amascutChatMessage("The mice fight back?");
                    soundEngine.playClip(Sound.AMASCUT_TELEPORT_1, executor);
                    antiSpam = 5;
                }
                if (fakeNpcLocation.getX() == 6208 && antiSpam == 0) {
                    amascutChatMessage("You dare to turn your back on me?");
                    soundEngine.playClip(Sound.AMASCUT_TELEPORT_2, executor);
                    antiSpam = 5;
                }
            }

            if (amascutStatus == Status.AMASCUT_IDLE.getStatus() && turnTimer == 0 && Math.abs(amascut.getOrientation() - oldOrientation) >= 5) {
                amascutStatus = Status.AMASCUT_TURN.getStatus();
                turnTimer = 20;
                setAnimation(CustomAnimation.AMASCUT_WALK_1.getAnimationID());
            }

            if (amascutStatus == Status.AMASCUT_TURN.getStatus() && turnTimer == 0 && amascut.getOrientation() == oldOrientation) {
                amascutStatus = Status.AMASCUT_IDLE.getStatus();
                turnTimer = 100;
                if (phase == 3)
                    setAnimation(CustomAnimation.AMASCUT_IDLE_2.getAnimationID());
                else
                    setAnimation(CustomAnimation.AMASCUT_IDLE_1.getAnimationID());
            }

            if (amascutStatus == Status.AMASCUT_SUMMON_PHANTOM_1.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                amascutStatus = Status.AMASCUT_SUMMON_PHANTOM_2.getStatus();
                switch(random.nextInt(3)) {
                    case 0:
                        setAnimation(CustomAnimation.AMASCUT_CAST_6.getAnimationID());
                        break;
                    case 1:
                        setAnimation(CustomAnimation.AMASCUT_CAST_7.getAnimationID());
                        break;
                    case 2:
                        setAnimation(CustomAnimation.AMASCUT_CAST_10.getAnimationID());
                        break;
                }
            }

            if (amascutStatus == Status.AMASCUT_ENRAGE_1.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                amascutStatus = Status.AMASCUT_ENRAGE_2.getStatus();
                setAnimation(CustomAnimation.AMASCUT_ENRAGE_2.getAnimationID());
            }

            if (amascutStatus == Status.AMASCUT_ENRAGE_2.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                amascutStatus = Status.AMASCUT_ENRAGE_3.getStatus();
                setAnimation(CustomAnimation.AMASCUT_ENRAGE_3.getAnimationID());
            }

            if (amascutStatus == Status.AMASCUT_ENRAGE_3.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                if (amascut.getAnimationController() != null)
                    amascut.getAnimationController().setFrame(16);
            }

            if (amascutStatus == Status.AMASCUT_END.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(amascut)) {
                resetWardens();
            }
        }
    }

    public void onGameTick(GameTick event) {
        if (ticksSinceEncounterStart >= 0)
            ticksSinceEncounterStart++;
        if (ticksSinceLastQuote >= 0)
            ticksSinceLastQuote++;

        // Delayed messages
        if (amascutMonologue > 0 && client.getTickCount() == messageDelay) {
            switch(amascutMonologue) {
                case 1:
                    fakeNpcHandler.addOverheadText(amascut, "Amascut","How close it came to becoming a reality.", 8, true);
                    amascutMonologue = 2;
                    messageDelay = client.getTickCount() + 8;
                    soundEngine.playClip(Sound.AMASCUT_START_2, executor);
                    break;
                case 2:
                    amascutChatMessage("Picture the heroes who would have risen against me.");
                    amascutMonologue = 3;
                    messageDelay = client.getTickCount() + 5;
                    soundEngine.playClip(Sound.AMASCUT_START_3, executor);
                    break;
                case 3:
                    amascutChatMessage("The challenges they would have overcome.");
                    amascutMonologue = 4;
                    messageDelay = client.getTickCount() + 4;
                    soundEngine.playClip(Sound.AMASCUT_START_4, executor);
                    break;
                case 4:
                    amascutChatMessage("And the rewards they would have reaped.");
                    amascutMonologue = 5;
                    messageDelay = client.getTickCount() + 5;
                    soundEngine.playClip(Sound.AMASCUT_START_5, executor);
                    break;
                case 5:
                    fakeNpcHandler.addOverheadText(amascut, "Amascut","Who among you is worthy of facing a goddess?", 7, true);
                    amascutMonologue = 6;
                    messageDelay = client.getTickCount() + 7;
                    soundEngine.playClip(Sound.AMASCUT_START_6, executor);
                    break;
                case 6:
                    amascutChatMessage("Show me...");
                    amascutMonologue = 0;
                    messageDelay = -1;
                    soundEngine.playClip(Sound.AMASCUT_START_7, executor);
                    break;
                case 7:
                    switch(random.nextInt(3)) {
                        case 0:
                            amascutChatMessage("FALL TO THE SHADOW!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_5, executor);
                            break;
                        case 1:
                            amascutChatMessage("YOU ARE NOTHING!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_6, executor);
                            break;
                        case 2:
                            amascutChatMessage("MWAHAHAHA!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_7, executor);
                            break;
                    }
                    amascutStatus = Status.AMASCUT_CAST.getStatus();
                    setAnimation(CustomAnimation.AMASCUT_CAST_5.getAnimationID());
                    amascutMonologue = 0;
                    messageDelay = -1;
                    break;
                case 8:
                    amascutChatMessage("It is not merely my power you face!");
                    amascutMonologue = 9;
                    messageDelay = client.getTickCount() + 10;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_1, executor);
                    break;
                case 9:
                    if (!tumekenP3) {
                        amascutChatMessage("Het...Scabaras...Bear witness!");
                        soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_2, executor);
                    }
                    else {
                        amascutChatMessage("Bring forth Crondis and Apmeken!");
                        soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_3, executor);
                    }
                    amascutMonologue = 10;
                    messageDelay = client.getTickCount() + 50;
                    amascutStatus = Status.AMASCUT_SUMMON_PHANTOM_1.getStatus();
                    switch(random.nextInt(3)) {
                        case 0:
                            setAnimation(CustomAnimation.AMASCUT_CAST_6.getAnimationID());
                            break;
                        case 1:
                            setAnimation(CustomAnimation.AMASCUT_CAST_7.getAnimationID());
                            break;
                        case 2:
                            setAnimation(CustomAnimation.AMASCUT_CAST_10.getAnimationID());
                            break;
                    }
                    break;
                case 10:
                    amascutChatMessage("There can be no light without darkness.");
                    amascutMonologue = 11;
                    messageDelay = client.getTickCount() + 20;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_4, executor);
                    break;
                case 11:
                    amascutChatMessage("Your light will be snuffed out, once and for all!");
                    amascutMonologue = 12;
                    messageDelay = client.getTickCount() + 50;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_5, executor);
                    break;
                case 12:
                    amascutChatMessage("Our father will be reborn!");
                    amascutMonologue = 13;
                    messageDelay = client.getTickCount() + 20;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_6, executor);
                    break;
                case 13:
                    amascutChatMessage("His soul will be judged and condemned!");
                    amascutMonologue = 14;
                    messageDelay = client.getTickCount() + 20;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_7, executor);
                    break;
                case 14:
                    amascutChatMessage("I will have my vengeance!");
                    amascutMonologue = 15;
                    messageDelay = client.getTickCount() + 40;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_8, executor);
                    break;
                case 15:
                    amascutChatMessage("Tumeken's heart...I will claw it out myself if I have to!");
                    amascutMonologue = 16;
                    messageDelay = client.getTickCount() + 40;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_9, executor);
                    break;
                case 16:
                    amascutChatMessage("Was I nothing to him?");
                    amascutMonologue = 17;
                    messageDelay = client.getTickCount() + 40;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_10, executor);
                    break;
                case 17:
                    amascutChatMessage("So be it...");
                    amascutMonologue = 18;
                    messageDelay = client.getTickCount() + 15;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_11, executor);
                    break;
                case 18:
                    amascutChatMessage("Come, mortal.");
                    amascutMonologue = 19;
                    messageDelay = client.getTickCount() + 10;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_12, executor);
                    break;
                case 19:
                    amascutChatMessage("If I cannot judge his soul, then I will condemn yours in its place.");
                    amascutMonologue = 20;
                    messageDelay = client.getTickCount() + 40;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_13, executor);
                    break;
                case 20:
                    amascutChatMessage("I am the one who devours.");
                    amascutMonologue = 21;
                    messageDelay = client.getTickCount() + 25;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_14, executor);
                    break;
                case 21:
                    amascutChatMessage("I AM");
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_15, executor);
                    amascutMonologue = 22;
                    messageDelay = client.getTickCount() + 15;
                    amascutStatus = Status.AMASCUT_ENRAGE_1.getStatus();
                    setAnimation(CustomAnimation.AMASCUT_ENRAGE_1.getAnimationID());
                    break;
                case 22:
                    amascutChatMessage("THE GOD");
                    amascutMonologue = 23;
                    messageDelay = client.getTickCount() + 15;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_16, executor);
                    break;
                case 23:
                    amascutChatMessage("OF");
                    amascutMonologue = 24;
                    messageDelay = client.getTickCount() + 15;
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_17, executor);
                    break;
                case 24:
                    amascutChatMessage("DESTRUCTION!");
                    soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_18, executor);
                    amascutMonologue = 0;
                    messageDelay = -1;
                    break;
                default:
                    break;
            }
        }

        if (isInWardensArena() && amascut != null) {
            if (phase != 3) {
                if (amascutTeleportTimer < 0)
                    amascutTeleportTimer++;

                // Teleport based on player location
                if (client.getLocalPlayer().getLocalLocation().getX() > 6720) {
                    if (amascut.getLocation().getX() != 7744) {
                        amascutTeleport();
                    }
                }
                else if (client.getLocalPlayer().getLocalLocation().getX() < 5696) {
                    if (amascut.getLocation().getX() != 4672) {
                        amascutTeleport();
                    }
                }
                else if (client.getLocalPlayer().getLocalLocation().getY() > 6464) {
                    if (amascut.getLocation().getY() != 6592) {
                        amascutTeleport();
                    }
                }
                else if (client.getLocalPlayer().getLocalLocation().getY() < 6464) {
                    if (amascut.getLocation().getY() != 6336) {
                        amascutTeleport();
                    }
                }
                else if (amascutTeleportTimer > 0)
                    amascutTeleportTimer--;

                // P1 quotes
                if (phase == 1) {
                    if ((ticksSinceEncounterStart - 15) % 50 == 0 && antiSpam == 0) {
                        int x = random.nextInt(4);
                        while (x == lastPhrase)
                            x = random.nextInt(4);
                        lastPhrase = x;
                        switch (x) {
                            case 0:
                                amascutChatMessage("Bend the knee!");
                                soundEngine.playClip(Sound.AMASCUT_OBELISK_1, executor);
                                break;
                            case 1:
                                amascutChatMessage("Grovel!");
                                soundEngine.playClip(Sound.AMASCUT_OBELISK_2, executor);
                                break;
                            case 2:
                                amascutChatMessage("Pathetic.");
                                soundEngine.playClip(Sound.AMASCUT_OBELISK_3, executor);
                                break;
                            case 3:
                                amascutChatMessage("Weak.");
                                soundEngine.playClip(Sound.AMASCUT_OBELISK_4, executor);
                                break;
                        }
                        setAnimation(CustomAnimation.AMASCUT_CAST_1.getAnimationID());
                        amascutStatus = Status.AMASCUT_CAST.getStatus();
                        ticksSinceLastQuote = 0;
                        antiSpam = 20;
                    }
                }

                // P2 quotes
                if (phase == 2) {
                    if (ticksSinceEncounterStart % 50 == 0 && antiSpam == 0) {
                        int x = random.nextInt(6);
                        while (x == lastPhrase)
                            x = random.nextInt(6);
                        lastPhrase = x;
                        switch (x) {
                            case 0:
                                amascutChatMessage("Tear them apart!");
                                soundEngine.playClip(Sound.AMASCUT_P2_1, executor);
                                break;
                            case 1:
                                amascutChatMessage("Even with your strength combined, you cannot stop me!");
                                soundEngine.playClip(Sound.AMASCUT_P2_2, executor);
                                break;
                            case 2:
                                amascutChatMessage("Resourcefulness will not save you!");
                                soundEngine.playClip(Sound.AMASCUT_P2_3, executor);
                                break;
                            case 3:
                                amascutChatMessage("I am a god!");
                                soundEngine.playClip(Sound.AMASCUT_P2_4, executor);
                                break;
                            case 4:
                                amascutChatMessage("Death is the only peace!");
                                soundEngine.playClip(Sound.AMASCUT_P2_5, executor);
                                break;
                            case 5:
                                amascutChatMessage("Your companions will betray you... they always do.");
                                soundEngine.playClip(Sound.AMASCUT_P2_6, executor);
                                break;
                        }
                        ticksSinceLastQuote = 0;
                    }
                }

                // P2 special attack projectile hits player
                if (client.getTickCount() == projectileImpactTick && antiSpam == 0) {
                    switch (specialProjectile) {
                        case 2204:
                            amascutChatMessage("All strength withers!");
                            amascutStatus = Status.AMASCUT_CAST.getStatus();
                            soundEngine.playClip(Sound.AMASCUT_ARCANE_1, executor);
                            setAnimation(CustomAnimation.AMASCUT_CAST_2.getAnimationID());
                            break;
                        case 2206:
                            amascutChatMessage("I will not suffer this.");
                            amascutStatus = Status.AMASCUT_CAST.getStatus();
                            soundEngine.playClip(Sound.AMASCUT_ARCANE_2, executor);
                            setAnimation(CustomAnimation.AMASCUT_CAST_3.getAnimationID());
                            break;
                        case 2208:
                            amascutChatMessage("Your soul is WEAK!");
                            amascutStatus = Status.AMASCUT_CAST.getStatus();
                            soundEngine.playClip(Sound.AMASCUT_ARCANE_3, executor);
                            setAnimation(CustomAnimation.AMASCUT_CAST_4.getAnimationID());
                            break;
                    }
                    antiSpam = 10;
                }
            }
        }

        if (!isInWardensArena())
            resetWardens();
        else
            fakeNpcHandler.onGameTick(event);

        if (antiSpam > 0)
            antiSpam--;
    }

    public void onNpcChanged(NpcChanged event) {
        int npcID = event.getNpc().getId();

        if (amascut != null) {
            // Warden P2 initiated
            if (phase == 1 && 11753 <= npcID && npcID <= 11757) {
                boss = event.getNpc();
                phase = 2;
                ticksSinceEncounterStart = 0;
                ticksSinceLastQuote = 0;
            }
        }
    }

    public void onNpcSpawned(NpcSpawned event) {
        int npcID = event.getNpc().getId();

        // Warden P3 initiated
        if (npcID == 11761 || npcID == 11762) {
            boss = event.getNpc();
            phase = 3;
            ticksSinceEncounterStart = 0;
            ticksSinceLastQuote = 0;

            amascut = fakeNpcHandler.createFakeNpc(NpcID.AMASCUT_11696, CustomAnimation.AMASCUT_IDLE_2.getAnimationID(),
                    boss.getLocalLocation().getX()+384, boss.getLocalLocation().getY());
            fakeNpcHandler.getOverlay().setMaxTextHeightOffset(680);
            fakeNpcHandler.getOverlay().setMinTextHeightOffset(620);
            amascut.setOrientation(1024);
            amascutStatus = Status.AMASCUT_IDLE.getStatus();
            amascutMonologue = 8;
            messageDelay = client.getTickCount() + 25;

            switch (random.nextInt(6)) {
                case 0:
                    amascutChatMessage("Watch as this vision becomes reality!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_1, executor);
                    break;
                case 1:
                    amascutChatMessage("Behold! The fate of this world!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_2, executor);
                    break;
                case 2:
                    amascutChatMessage("Prove that you have the will to stand against the vision of a GODDESS!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_3, executor);
                    break;
                case 3:
                    amascutChatMessage("I will tear this world asunder!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_4, executor);
                    break;
                case 4:
                    amascutChatMessage("Let us see if these delusions of grandeur can withstand The Devourer's maw!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_5, executor);
                    break;
                case 5:
                    amascutChatMessage("Behold the inevitable future!");
                    soundEngine.playClip(Sound.AMASCUT_P3_START_6, executor);
                    break;
            }
        }
    }

    public void onAnimationChanged(AnimationChanged event) {
        if (boss != null && event.getActor() == boss) {
            if (amascut != null) {
                // Warden transition from P2 to P3
                if (boss.getAnimation() == 9662) {
                    switch (random.nextInt(4)) {
                        case 0:
                            amascutChatMessage("I WILL NOT BE DENIED.");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_1, executor);
                            break;
                        case 1:
                            amascutChatMessage("I WILL NOT BE SUBJUGATED BY A MORTAL!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_2, executor);
                            break;
                        case 2:
                            amascutChatMessage("It is NOT over!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_3, executor);
                            break;
                        case 3:
                            amascutChatMessage("ENOUGH!");
                            soundEngine.playClip(Sound.AMASCUT_P2_END_4, executor);
                            break;
                    }
                    amascutStatus = Status.AMASCUT_CAST.getStatus();
                    setAnimation(CustomAnimation.AMASCUT_CAST_9.getAnimationID());
                    amascutMonologue = 7;
                    messageDelay = client.getTickCount() + 5;
                    antiSpam = 20;
                }

                // Warden P3 skulls failed
                if (boss.getAnimation() == 9681) {
                    amascutChatMessage("DESTRUCTION!");
                    switch (random.nextInt(3)) {
                        case 0:
                            soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_18, executor);
                            break;
                        case 1:
                            soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_19, executor);
                            break;
                        case 2:
                            soundEngine.playClip(Sound.AMASCUT_P3_MONOLOGUE_20, executor);
                            break;
                    }
                    amascutStatus = Status.AMASCUT_CAST.getStatus();
                    setAnimation(CustomAnimation.AMASCUT_CAST_8.getAnimationID());
                }
            }
        }
    }

    public void onActorDeath(ActorDeath actorDeath)
    {
        Actor actor = actorDeath.getActor();
        if (actor instanceof Player)
        {
            if (isInWardensArena() && amascut != null) {
                switch(random.nextInt(2)) {
                    case 0:
                        amascutChatMessage("Unworthy!");
                        soundEngine.playClip(Sound.AMASCUT_DEFEAT_1, executor);
                        break;
                    case 1:
                        amascutChatMessage("There is no place for you in my world.");
                        soundEngine.playClip(Sound.AMASCUT_DEFEAT_2, executor);
                        break;
                }
            }
        }
    }

    public void onProjectileMoved(ProjectileMoved event) {
        int projectileID = event.getProjectile().getId();
        if (projectileID == 2204 || projectileID == 2206 || projectileID == 2208) {
            projectileImpactTick = client.getTickCount() + event.getProjectile().getRemainingCycles() / 30;
            specialProjectile = projectileID;
        }
    }

    public void amascutChatMessage(String message) {
        if (amascut != null) {
            fakeNpcHandler.addOverheadText(amascut, "Amascut", message);
        }
    }

    public void setAnimation(int animationID) {
        if (amascut.getAnimationController() != null)
            amascut.getAnimationController().setAnimation(client.loadAnimation(animationID));
    }

    public void resetWardens() {
        amascutStatus = Status.INACTIVE.getStatus();
        antiSpam = 0;
        amascutMonologue = 0;
        turnTimer = 0;
        phase = 0;
        messageDelay = -1;
        tumekenP3 = true;
        if (amascut != null)
            amascut.setActive(false);
        amascut = null;
        lastPhrase = -1;
        ticksSinceEncounterStart = -1;
        ticksSinceLastQuote = -1;
        specialProjectile = 0;
        if (isInWardensArena())
            fakeNpcHandler.getOverlay().setOverheadText("");
    }
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.sound.SoundEngine;
import net.runelite.api.Client;
import net.runelite.client.chat.ChatMessageManager;

import java.util.concurrent.ScheduledExecutorService;

public interface Boss {
    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay);
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.*;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.util.Text;

import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;

public class Graardor implements Boss {
    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    private final Random random = new Random();

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
    }

    public void onOverheadTextChanged(OverheadTextChanged event) {
        if (event.getActor() != null && event.getActor().getName() != null && event.getOverheadText() != null) {
            if (event.getActor().getName().equals("General Graardor")) {
                String text = Text.removeTags(event.getOverheadText());
                switch (text) {
                    case "All glory to Bandos!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_1, executor);
                        break;
                    case "Brargh!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_2, executor);
                        break;
                    case "Break their bones!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_3, executor);
                        break;
                    case "CHAAARGE!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_4, executor);
                        break;
                    case "Crush them underfoot!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_5, executor);
                        break;
                    case "Death to our enemies!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_6, executor);
                        break;
                    case "For the glory of the Big High War God!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_7, executor);
                        break;
                    case "GRRRAAAAAR!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_8, executor);
                        break;
                    case "Split their skulls!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_9, executor);
                        break;
                    case "We feast on the bones of our enemies tonight!":
                        soundEngine.playClip(Sound.GRAARDOR_OVERHEAD_10, executor);
                        break;
                }
            }
        }
    }

    public void onSoundEffectPlayed(SoundEffectPlayed event) {
        if (event.getSoundId() == 3838) {
            event.consume();
            switch(random.nextInt(2)) {
                case 0:
                    soundEngine.playClip(Sound.GRAARDOR_DEATH_1, executor);
                    break;
                case 1:
                    soundEngine.playClip(Sound.GRAARDOR_DEATH_2, executor);
                    break;
            }
        }
    }
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.Client;
import net.runelite.api.events.OverheadTextChanged;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.util.Text;

import java.util.concurrent.ScheduledExecutorService;

public class Kreearra implements Boss {
    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
    }

    public void onOverheadTextChanged(OverheadTextChanged event) {
        if (event.getActor() != null && event.getActor().getName() != null && event.getOverheadText() != null) {
            if (event.getActor().getName().equals("Kree'arra")) {
                String text = Text.removeTags(event.getOverheadText());
                switch (text) {
                    case "Kraaaw!":
                        soundEngine.playClip(Sound.KREEARRA_KRAAW, executor);
                        break;
                    case "Skreeeee!":
                        soundEngine.playClip(Sound.KREEARRA_SKREE, executor);
                        break;
                }
            }
        }
    }

}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.Client;
import net.runelite.api.events.OverheadTextChanged;
import net.runelite.api.events.SoundEffectPlayed;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.util.Text;

import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;

public class Kril implements Boss {
    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    private final Random random = new Random();

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
    }

    public void onOverheadTextChanged(OverheadTextChanged event) {
        if (event.getActor() != null && event.getActor().getName() != null && event.getOverheadText() != null) {
            if (event.getActor().getName().equals("K'ril Tsutsaroth")) {
                String text = Text.removeTags(event.getOverheadText());
                switch (text) {
                    case "Attack!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_1, executor);
                        break;
                    case "Attack them, you dogs!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_2, executor);
                        break;
                    case "Death to Saradomin's dogs!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_3, executor);
                        break;
                    case "Flay them all!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_4, executor);
                        break;
                    case "Forward!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_5, executor);
                        break;
                    case "Kill them, you cowards!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_6, executor);
                        break;
                    case "No retreat!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_7, executor);
                        break;
                    case "Rend them limb from limb!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_8, executor);
                        break;
                    case "The Dark One will have their souls!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_9, executor);
                        break;
                    case "Zamorak curse them!":
                        soundEngine.playClip(Sound.KRIL_OVERHEAD_10, executor);
                        break;
                    case "YARRRRRRR!":
                        soundEngine.playClip(Sound.KRIL_YARRR, executor);
                        break;
                }
            }
        }
    }

    public void onSoundEffectPlayed(SoundEffectPlayed event) {
        if (event.getSoundId() == 3864) {
            event.consume();
            soundEngine.playClip(Sound.KRIL_DEATH, executor);
        }
    }
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.animation.CustomAnimation;
import com.rs3voiceovers.animation.FakeNpcHandler;
import com.rs3voiceovers.animation.Status;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.*;
import net.runelite.api.coords.LocalPoint;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatMessageManager;
import org.apache.commons.lang3.ArrayUtils;

import java.util.Objects;
import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;

public class Zemouregal implements Boss {
    private static final int UNGAEL_REGION_ID = 9023;

    @Getter @Setter
    private NPC boss;
    @Getter @Setter
    private RuneLiteObject zemouregal;
    @Getter @Setter
    private int zemouregalStatus = Status.INACTIVE.getStatus();
    @Getter @Setter
    private LocalPoint zemouregalLocation;
    @Getter @Setter
    private FakeNpcHandler fakeNpcHandler = new FakeNpcHandler();

    private int ticksSinceEncounterStart = -1;
    private int ticksSinceLastQuote = -1;
    private int antiSpam = 0;
    private int turnTimer = 0;

    private int lastPhrase = -1;

    private boolean zemoFaceVorkath = false;

    private final Random random = new Random();

    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
        fakeNpcHandler.setClient(client);
        fakeNpcHandler.setChatMessageManager(chatMessageManager);
        fakeNpcHandler.setOverlay(overlay);
    }

    private boolean isOnUngael() {
        return client.getMapRegions() != null && ArrayUtils.contains(client.getMapRegions(), UNGAEL_REGION_ID) && client.getTopLevelWorldView().isInstance();
    }

    public void onClientTick(ClientTick event) {
        if (turnTimer > 0)
            turnTimer--;

        if (isOnUngael() && zemouregal != null) {
            int oldOrientation = zemouregal.getOrientation();

            if (zemoFaceVorkath)
                zemouregal.setOrientation(1536);
            else
                fakeNpcHandler.facePlayer(zemouregal);

            if (zemouregalStatus == Status.ZEMOUREGAL_START.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(zemouregal)) {
                zemouregalStatus = Status.ZEMOUREGAL_CAST.getStatus();
                setAnimation(CustomAnimation.ZEMOUREGAL_CAST_1.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_CAST.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(zemouregal)) {
                zemoFaceVorkath = false;
                zemouregalStatus = Status.ZEMOUREGAL_IDLE.getStatus();
                setAnimation(CustomAnimation.ZEMOUREGAL_IDLE.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_SPELL_WINDUP.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(zemouregal)) {
                zemouregalStatus = Status.ZEMOUREGAL_SPELL.getStatus();
                setAnimation(CustomAnimation.ZEMOUREGAL_CAST_6.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_SPELL.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(zemouregal)) {
                zemouregalStatus = Status.ZEMOUREGAL_IDLE.getStatus();
                setAnimation(CustomAnimation.ZEMOUREGAL_IDLE.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_IDLE.getStatus() && turnTimer == 0 && Math.abs(zemouregal.getOrientation() - oldOrientation) >= 5) {
                zemouregalStatus = Status.ZEMOUREGAL_TURN.getStatus();
                turnTimer = 20;
                setAnimation(CustomAnimation.ZEMOUREGAL_WALK_1.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_TURN.getStatus() && turnTimer == 0 && zemouregal.getOrientation() == oldOrientation) {
                zemouregalStatus = Status.ZEMOUREGAL_IDLE.getStatus();
                turnTimer = 20;
                setAnimation(CustomAnimation.ZEMOUREGAL_IDLE.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_END.getStatus()) {
                zemouregalStatus = Status.ZEMOUREGAL_DESPAWN.getStatus();
                setAnimation(CustomAnimation.ZEMOUREGAL_DESPAWN.getAnimationID());
            }

            if (zemouregalStatus == Status.ZEMOUREGAL_DESPAWN.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(zemouregal)) {
                resetVorkath();
            }
        }
    }

    public void onGameTick(GameTick event) {
        // Reset variables if no longer in boss arena
        if (!isOnUngael())
            resetVorkath();
        else
            fakeNpcHandler.onGameTick(event);

        if (ticksSinceEncounterStart >= 0)
            ticksSinceEncounterStart++;
        if (ticksSinceLastQuote >= 0)
            ticksSinceLastQuote++;

        if (antiSpam > 0)
            antiSpam--;

        // Random interval dialogue - Zemouregal
        if (isOnUngael() && zemouregal != null) {

            int quoteChance = 110 - ticksSinceLastQuote * 2;
            if (quoteChance < 1)
                quoteChance = 1;

            if (ticksSinceEncounterStart % 100 == 0 && random.nextInt(3) == 0 && antiSpam == 0) {
                switch (random.nextInt(5)) {
                    case 0:
                        zemouregalChatMessage("This piteous joke ends now.");
                        soundEngine.playClip(Sound.VORKATH_UNCOMMON_1, executor);
                        break;
                    case 1:
                        zemouregalChatMessage("DIE!");
                        soundEngine.playClip(Sound.VORKATH_UNCOMMON_2, executor);
                        break;
                    case 2:
                        zemouregalChatMessage("Say farewell, little one!");
                        soundEngine.playClip(Sound.VORKATH_UNCOMMON_3, executor);
                        break;
                    case 3:
                        zemouregalChatMessage("Cut them down without mercy!");
                        soundEngine.playClip(Sound.VORKATH_UNCOMMON_4, executor);
                        break;
                    case 4:
                        zemouregalChatMessage("Cast my glorious vengeance down upon them!");
                        soundEngine.playClip(Sound.VORKATH_UNCOMMON_5, executor);
                        break;
                }
                switch (random.nextInt(4)) {
                    case 0:
                        zemouregalStatus = Status.ZEMOUREGAL_SPELL.getStatus();
                        setAnimation(CustomAnimation.ZEMOUREGAL_CAST_2.getAnimationID());
                        break;
                    case 1:
                        zemouregalStatus = Status.ZEMOUREGAL_SPELL.getStatus();
                        setAnimation(CustomAnimation.ZEMOUREGAL_CAST_3.getAnimationID());
                        break;
                    case 2:
                        zemouregalStatus = Status.ZEMOUREGAL_SPELL.getStatus();
                        setAnimation(CustomAnimation.ZEMOUREGAL_CAST_4.getAnimationID());
                        break;
                    case 3:
                        zemouregalStatus = Status.ZEMOUREGAL_SPELL_WINDUP.getStatus();
                        setAnimation(CustomAnimation.ZEMOUREGAL_CAST_5.getAnimationID());
                        break;
                }
                antiSpam = 5;
                ticksSinceLastQuote = 0;
            }
            else if (ticksSinceLastQuote >= 15 && random.nextInt(quoteChance) == 0 && antiSpam == 0) {
                int x = random.nextInt(12);
                while (x == lastPhrase)
                    x = random.nextInt(12);
                lastPhrase = x;
                switch (x) {
                    case 0:
                        zemouregalChatMessage("Your struggle, like your life, is meaningless.");
                        soundEngine.playClip(Sound.VORKATH_COMMON_1, executor);
                        break;
                    case 1:
                        zemouregalChatMessage("No one can stand against my mighty undead!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_2, executor);
                        break;
                    case 2:
                        zemouregalChatMessage("No escape, you puny knave!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_3, executor);
                        break;
                    case 3:
                        zemouregalChatMessage("You WILL yield to my might!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_4, executor);
                        break;
                    case 4:
                        zemouregalChatMessage("Be gone, gnawing pest!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_5, executor);
                        break;
                    case 5:
                        zemouregalChatMessage("You will be one with my undead troops.");
                        soundEngine.playClip(Sound.VORKATH_COMMON_6, executor);
                        break;
                    case 6:
                        zemouregalChatMessage("These are your final moments, halfwit!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_7, executor);
                        break;
                    case 7:
                        zemouregalChatMessage("I'll make a feast of your blood, and be strengthened!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_8, executor);
                        break;
                    case 8:
                        zemouregalChatMessage("Why do you bother to test me?");
                        soundEngine.playClip(Sound.VORKATH_COMMON_9, executor);
                        break;
                    case 9:
                        zemouregalChatMessage("You thought you were a match for my majesty?");
                        soundEngine.playClip(Sound.VORKATH_COMMON_10, executor);
                        break;
                    case 10:
                        zemouregalChatMessage("I shall rend the very flesh from your bones!");
                        soundEngine.playClip(Sound.VORKATH_COMMON_11, executor);
                        break;
                    case 11:
                        zemouregalChatMessage("Pah! Pitiful.");
                        soundEngine.playClip(Sound.VORKATH_COMMON_12, executor);
                        break;
                }
                antiSpam = 5;
                ticksSinceLastQuote = 0;
            }
        }
    }

    public void onNpcChanged(NpcChanged event) {
        if (event.getNpc() == null)
            return;

        int npcID = event.getNpc().getId();

        // Vorkath combat begins
        if (event.getOld().getId() == 8058 && npcID == 8061) {
            boss = event.getNpc();
            ticksSinceEncounterStart = 0;
            ticksSinceLastQuote = 0;
        }
        // Vorkath initiated
        if (event.getOld().getId() == 8059 && npcID == 8058) {
            boss = event.getNpc();
            resetVorkath();
            zemouregal = fakeNpcHandler.createFakeNpc(NpcID.ZEMOUREGAL, CustomAnimation.ZEMOUREGAL_SPAWN.getAnimationID(),
                         boss.getLocalLocation().getX() - 384, boss.getLocalLocation().getY() - 256);
            fakeNpcHandler.getOverlay().setMaxTextHeightOffset(380);
            fakeNpcHandler.getOverlay().setMinTextHeightOffset(320);
            zemouregalStatus = Status.ZEMOUREGAL_START.getStatus();
            zemoFaceVorkath = true;

            switch (random.nextInt(3)) {
                case 0:
                    zemouregalChatMessage("Obey your master, you dumb puppet!");
                    soundEngine.playClip(Sound.VORKATH_START_1, executor);
                    break;
                case 1:
                    zemouregalChatMessage("The dragon WILL be mine!");
                    soundEngine.playClip(Sound.VORKATH_START_2, executor);
                    break;
                case 2:
                    zemouregalChatMessage("Rise you cursed weakling, I shan't tell you again!");
                    soundEngine.playClip(Sound.VORKATH_START_3, executor);
                    break;
            }
        }
    }

    public void onActorDeath(ActorDeath actorDeath)
    {
        Actor actor = actorDeath.getActor();
        if (actor instanceof Player) {
            Player player = (Player) actor;
            if (isOnUngael() && zemouregal != null && player == client.getLocalPlayer()) {
                switch(random.nextInt(5)) {
                    case 0:
                        zemouregalChatMessage("Say hello to Death for me!");
                        soundEngine.playClip(Sound.VORKATH_DEFEAT_1, executor);
                        break;
                    case 1:
                        zemouregalChatMessage("Death is, quite frankly, too good for you.");
                        soundEngine.playClip(Sound.VORKATH_DEFEAT_2, executor);
                        break;
                    case 2:
                        zemouregalChatMessage("Finally, an end to your meddling.");
                        soundEngine.playClip(Sound.VORKATH_DEFEAT_3, executor);
                        break;
                    case 3:
                        zemouregalChatMessage("Death protects you? I meant to have you for my own...");
                        soundEngine.playClip(Sound.VORKATH_DEFEAT_4, executor);
                        break;
                    case 4:
                        zemouregalChatMessage("Your life is payment for this folly!");
                        soundEngine.playClip(Sound.VORKATH_DEFEAT_5, executor);
                        break;
                }
                antiSpam = 5;
                ticksSinceLastQuote = 0;
            }
        }

        if (Objects.equals(actor.getName(), "Vorkath") && zemouregal != null) {
            switch(random.nextInt(5)) {
                case 0:
                    fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", "Bah! Useless!",3,true);
                    soundEngine.playClip(Sound.VORKATH_VICTORY_1, executor);
                    break;
                case 1:
                    fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", "Are you determined to fail?",3,true);
                    soundEngine.playClip(Sound.VORKATH_VICTORY_2, executor);
                    break;
                case 2:
                    fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", "GET UP! - Why must you test my patience?",3,true);
                    soundEngine.playClip(Sound.VORKATH_VICTORY_3, executor);
                    break;
                case 3:
                    fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", "Urgh, must I be forever plagued by lesser beings?",3,true);
                    soundEngine.playClip(Sound.VORKATH_VICTORY_4, executor);
                    break;
                case 4:
                    fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", "Inadequate failure...",3,true);
                    soundEngine.playClip(Sound.VORKATH_VICTORY_5, executor);
                    break;
            }
            ticksSinceLastQuote = 0;
            antiSpam = 5;
            zemouregalStatus = Status.ZEMOUREGAL_END.getStatus();
        }
    }

    public void onHitsplatApplied(HitsplatApplied event) {
        // Stepping on Vorkath acid
        if (event.getActor().getName() != null               &&
                "Vorkath".equals(event.getActor().getName()) &&
                event.getHitsplat().getHitsplatType() == 6 && antiSpam == 0) {

            switch(random.nextInt(4)) {
                case 0:
                    zemouregalChatMessage("Suffocate this land with bile!");
                    soundEngine.playClip(Sound.VORKATH_POISON_1, executor);
                    break;
                case 1:
                    zemouregalChatMessage("Spew your venom, my malformed pet!");
                    soundEngine.playClip(Sound.VORKATH_POISON_2, executor);
                    break;
                case 2:
                    zemouregalChatMessage("Yes, heal the dumb beast!");
                    soundEngine.playClip(Sound.VORKATH_POISON_3, executor);
                    break;
                case 3:
                    zemouregalChatMessage("Drown in your own gore!");
                    soundEngine.playClip(Sound.VORKATH_POISON_4, executor);
                    break;
            }
            antiSpam = 10;
            ticksSinceLastQuote = 0;
        }
    }

    public void zemouregalChatMessage(String message) {
        if (zemouregal != null) {
            fakeNpcHandler.addOverheadText(zemouregal, "Zemouregal", message);
        }
    }

    public void setAnimation(int animationID) {
        if (zemouregal.getAnimationController() != null)
            zemouregal.getAnimationController().setAnimation(client.loadAnimation(animationID));
    }

    public void resetVorkath() {
        zemouregalStatus = Status.INACTIVE.getStatus();
        antiSpam = 0;
        zemoFaceVorkath = false;
        turnTimer = 0;

        if (isOnUngael())
            fakeNpcHandler.getOverlay().setOverheadText("");

        if (zemouregal != null)
            zemouregal.setActive(false);

        zemouregal = null;
        lastPhrase = -1;
        ticksSinceEncounterStart = -1;
        ticksSinceLastQuote = -1;
    }
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.Client;
import net.runelite.api.events.OverheadTextChanged;
import net.runelite.api.events.SoundEffectPlayed;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.util.Text;

import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;

public class Zilyana implements Boss {
    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;

    private final Random random = new Random();

    @Getter @Setter
    private boolean zilyanaHurt = false;

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
    }

    public void onOverheadTextChanged(OverheadTextChanged event) {
        if (event.getActor() != null && event.getActor().getName() != null && event.getOverheadText() != null) {
            if (event.getActor().getName().equals("Commander Zilyana")) {
                String text = Text.removeTags(event.getOverheadText());
                switch (text) {
                    case "All praise Saradomin!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_1, executor);
                        break;
                    case "Attack! Find the Godsword!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_2, executor);
                        break;
                    case "Death to the enemies of the light!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_3, executor);
                        break;
                    case "Forward! Our allies are with us!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_4, executor);
                        break;
                    case "Good will always triumph!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_5, executor);
                        break;
                    case "In the name of Saradomin!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_6, executor);
                        break;
                    case "May Saradomin be my sword!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_7, executor);
                        break;
                    case "Saradomin is with us!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_8, executor);
                        break;
                    case "Saradomin lend me strength!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_9, executor);
                        break;
                    case "Slay the evil ones!":
                        soundEngine.playClip(Sound.ZILYANA_OVERHEAD_10, executor);
                        break;
                }
            }
        }
    }

    public void onSoundEffectPlayed(SoundEffectPlayed event) {
        if (event.getSoundId() == 3860) {
            event.consume();
            switch(random.nextInt(3)) {
                case 0:
                    soundEngine.playClip(Sound.ZILYANA_DEATH_1, executor);
                    break;
                case 1:
                    soundEngine.playClip(Sound.ZILYANA_DEATH_2, executor);
                    break;
                case 2:
                    soundEngine.playClip(Sound.ZILYANA_DEATH_3, executor);
                    break;
            }
        }

        if (event.getSoundId() == 3858 && zilyanaHurt) {
            event.consume();
            switch (random.nextInt(4)) {
                case 0:
                    soundEngine.playClip(Sound.ZILYANA_HURT_1, executor);
                    break;
                case 1:
                    soundEngine.playClip(Sound.ZILYANA_HURT_2, executor);
                    break;
                case 2:
                    soundEngine.playClip(Sound.ZILYANA_HURT_3, executor);
                    break;
                case 3:
                    soundEngine.playClip(Sound.ZILYANA_HURT_4, executor);
                    break;
            }
        }
    }
}

package com.rs3voiceovers.bosses;

import com.rs3voiceovers.RS3VoiceoversOverlay;
import com.rs3voiceovers.animation.CustomAnimation;
import com.rs3voiceovers.animation.FakeNpcHandler;
import com.rs3voiceovers.animation.Status;
import com.rs3voiceovers.sound.Sound;
import com.rs3voiceovers.sound.SoundEngine;
import lombok.Getter;
import lombok.Setter;
import net.runelite.api.*;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatMessageManager;
import org.apache.commons.lang3.ArrayUtils;

import java.util.Objects;
import java.util.Random;
import java.util.concurrent.ScheduledExecutorService;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Zuk implements Boss {
    private static final int INFERNO_REGION_ID = 9043;
    private static final Pattern TZHAAR_WAVE_MESSAGE = Pattern.compile("Wave: (\\d+)");
    private static final Pattern JAD_CHALLENGE_MESSAGE = Pattern.compile("You enter the Inferno for");
    private static final Pattern JAD_CHALLENGE_VICTORY_MESSAGE = Pattern.compile("Your completion count for TzHaar-Ket-Rak's");

    @Getter @Setter
    private NPC boss;

    private int ticksSinceEncounterStart = -1;
    private int ticksSinceLastQuote = -1;
    private int antiSpam = 0;
    private int messageDelay = -1;

    private boolean infernoStart = false;
    private boolean zukFight = false;
    private boolean unpaused = false;
    private int unpauseBuffer = 0;
    private boolean isInJadChallenge = false;
    private int jadChallengeCheck = -8;
    private boolean loggingIn = false;

    private int lastPhrase = -1;

    private final Random random = new Random();

    @Getter @Setter
    private SoundEngine soundEngine;
    @Getter @Setter
    private ScheduledExecutorService executor;
    @Getter @Setter
    private Client client;
    @Getter @Setter
    private FakeNpcHandler fakeNpcHandler = new FakeNpcHandler();
    @Getter @Setter
    private RuneLiteObject fakeZuk;
    @Getter @Setter
    private int fakeZukStatus = Status.INACTIVE.getStatus();

    public void startUp(Client client, SoundEngine soundEngine, ScheduledExecutorService executor, ChatMessageManager chatMessageManager, RS3VoiceoversOverlay overlay) {
        this.client = client;
        this.soundEngine = soundEngine;
        this.executor = executor;
        fakeNpcHandler.setClient(client);
        fakeNpcHandler.setChatMessageManager(chatMessageManager);
        fakeNpcHandler.setOverlay(overlay);
    }

    private boolean isInInfernoArea() {
        return client.getMapRegions() != null && ArrayUtils.contains(client.getMapRegions(), INFERNO_REGION_ID);
    }

    private boolean isInInferno() {
        return !isInJadChallenge && client.getMapRegions() != null && ArrayUtils.contains(client.getMapRegions(), INFERNO_REGION_ID);
    }
    
    public void onChatMessage(ChatMessage event) {
        String message = event.getMessage();

        // Inferno start quote
        if (isInInferno()) {
            Matcher matcher = TZHAAR_WAVE_MESSAGE.matcher(message);
            if (matcher.find()) {
                int wave = Integer.parseInt(matcher.group(1));
                if (wave == 1 || unpaused)
                    ticksSinceEncounterStart = 0;
                if (wave == 69)
                    zukFight = true;
            }
        }

        // Jad challenge detect
        Matcher m = JAD_CHALLENGE_MESSAGE.matcher(message);
        if (m.find()) {
            isInJadChallenge = true;
            jadChallengeCheck = 15;
        }

        // Jad challenge victory quote
        Matcher matcher = JAD_CHALLENGE_VICTORY_MESSAGE.matcher(message);
        if (matcher.find()) {
            switch(random.nextInt(6)) {
                case 0:
                    zukChatMessage("Ungh. not bad...");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_1, executor);
                    break;
                case 1:
                    zukChatMessage("A champion rises.");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_2, executor);
                    break;
                case 2:
                    zukChatMessage("You have earned your right to live. For now.");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_3, executor);
                    break;
                case 3:
                    zukChatMessage("Hmph. Interesting...");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_4, executor);
                    break;
                case 4:
                    zukChatMessage("It appears you have exceeded my expectations.");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_5, executor);
                    break;
                case 5:
                    zukChatMessage("Not...so weak as you seem.");
                    soundEngine.playClip(Sound.ZUK_JAD_VICTORY_6, executor);
                    break;
            }
        }
    }

    public void onClientTick(ClientTick event) {
        if (fakeZukStatus == Status.ZUK_ATTACK.getStatus() && fakeNpcHandler.isOnFinalAnimationFrame(fakeZuk)) {
            fakeZukStatus = Status.ZUK_IDLE.getStatus();
            if (fakeZuk.getAnimationController() != null)
                fakeZuk.getAnimationController().setAnimation(client.loadAnimation(CustomAnimation.ZUK_IDLE.getAnimationID()));
        }
    }

    public void onGameTick(GameTick event) {
        if (jadChallengeCheck > 0)
            jadChallengeCheck--;

        if (jadChallengeCheck == 0 && !isInInfernoArea())
            isInJadChallenge = false;

        if (!isInJadChallenge) {
            if (fakeZuk != null) {
                fakeZuk.setActive(false);
                fakeNpcHandler.getOverlay().setOverheadText("");
            }
            fakeZuk = null;
        }

        // Jad challenge start quote
        if (jadChallengeCheck == 1 && isInInfernoArea()) {
            fakeZuk = fakeNpcHandler.createFakeNpc(NpcID.TZKALZUK, CustomAnimation.ZUK_ATTACK.getAnimationID(), 7104, 8256);
            fakeNpcHandler.getOverlay().setMaxTextHeightOffset(730);
            fakeNpcHandler.getOverlay().setMinTextHeightOffset(670);
            fakeZuk.setOrientation(0);
            fakeZukStatus = Status.ZUK_ATTACK.getStatus();

            switch(random.nextInt(3)) {
                case 0:
                    zukChatMessage("Rise, Jad!");
                    soundEngine.playClip(Sound.ZUK_JAD_1, executor);
                    break;
                case 1:
                    zukChatMessage("Unleash Jad!");
                    soundEngine.playClip(Sound.ZUK_JAD_2, executor);
                    break;
                case 2:
                    zukChatMessage("Enough. Jad will end this.");
                    soundEngine.playClip(Sound.ZUK_JAD_3, executor);
                    break;
            }
        }

        if (unpauseBuffer > 0)
            unpauseBuffer--;

        if (ticksSinceEncounterStart >= 0)
            ticksSinceEncounterStart++;
        if (ticksSinceLastQuote >= 0)
            ticksSinceLastQuote++;

        // Interval dialogue - Inferno waves
        if (isInInferno() && !zukFight) {
            int quoteChance = 250 - ticksSinceLastQuote;
            if (quoteChance < 1)
                quoteChance = 1;

            // Start/Unpausing of Inferno
            if (ticksSinceEncounterStart == 2) {
                if (!unpaused) {
                    zukChatMessage("A challenger approaches...");
                    soundEngine.playClip(Sound.ZUK_FIRST_WAVE_1, executor);
                    messageDelay = client.getTickCount() + 6;
                    infernoStart = true;
                }
                else {
                    zukChatMessage("Interesting...you return.");
                    soundEngine.playClip(Sound.ZUK_RELOG, executor);
                    unpaused = false;
                }
                ticksSinceLastQuote = 0;
            }

            // Delayed messages
            if (infernoStart && client.getTickCount() == messageDelay) {
                zukChatMessage("What makes you think you have what it takes?");
                soundEngine.playClip(Sound.ZUK_FIRST_WAVE_2, executor);
                infernoStart = false;
                ticksSinceLastQuote = 0;
            }

            // Random Interval dialogue
            if (ticksSinceLastQuote > 125 && random.nextInt(quoteChance) == 0 && antiSpam == 0) {
                int x = random.nextInt(12);
                while (x == lastPhrase)
                    x = random.nextInt(12);
                lastPhrase = x;
                switch (x) {
                    case 0:
                        zukChatMessage("Show me you are worthy!");
                        soundEngine.playClip(Sound.ZUK_WAVES_1, executor);
                        break;
                    case 1:
                        zukChatMessage("Fight, worm! Or crawl and die!");
                        soundEngine.playClip(Sound.ZUK_WAVES_2, executor);
                        break;
                    case 2:
                        zukChatMessage("To the slaughter!");
                        soundEngine.playClip(Sound.ZUK_WAVES_3, executor);
                        break;
                    case 3:
                        zukChatMessage("Prove your worth!");
                        soundEngine.playClip(Sound.ZUK_WAVES_4, executor);
                        break;
                    case 4:
                        zukChatMessage("Charge!");
                        soundEngine.playClip(Sound.ZUK_WAVES_5, executor);
                        break;
                    case 5:
                        zukChatMessage("Into the fray!");
                        soundEngine.playClip(Sound.ZUK_WAVES_6, executor);
                        break;
                    case 6:
                        zukChatMessage("The unworthy will burn.");
                        soundEngine.playClip(Sound.ZUK_WAVES_7, executor);
                        break;
                    case 7:
                        zukChatMessage("All of you, attack!");
                        soundEngine.playClip(Sound.ZUK_WAVES_8, executor);
                        break;
                    case 8:
                        zukChatMessage("Rise, scions of the Kiln!");
                        soundEngine.playClip(Sound.ZUK_WAVES_9, executor);
                        break;
                    case 9:
                        zukChatMessage("Fight or die!");
                        soundEngine.playClip(Sound.ZUK_WAVES_10, executor);
                        break;
                    case 10:
                        zukChatMessage("Die, and be reborn in flame!");
                        soundEngine.playClip(Sound.ZUK_WAVES_11, executor);
                        break;
                    case 11:
                        zukChatMessage("To ashes!");
                        soundEngine.playClip(Sound.ZUK_WAVES_12, executor);
                        break;
                }
                ticksSinceLastQuote = 0;
            }
        }

        // Random interval dialogue - Zuk
        if (isInInferno() && zukFight && boss != null) {

            int quoteChance = 13 - ticksSinceLastQuote / 10;
            if (quoteChance < 1)
                quoteChance = 1;

            if (ticksSinceEncounterStart == 600 && antiSpam == 0) {
                switch (random.nextInt(2)) {
                    case 0:
                        zukChatMessage("I grow weary of this. End it quickly!");
                        soundEngine.playClip(Sound.ZUK_ENRAGED_2, executor);
                        break;
                    case 1:
                        zukChatMessage("Fall, and burn to ash!");
                        soundEngine.playClip(Sound.ZUK_ENRAGED_1, executor);
                        break;
                }
                ticksSinceLastQuote = 0;
            }
            else if (ticksSinceEncounterStart % 10 == 0 && ticksSinceLastQuote >= 20 && antiSpam == 0 && random.nextInt(quoteChance) == 0) {
                int x = random.nextInt(14);
                while (x == lastPhrase)
                    x = random.nextInt(14);
                lastPhrase = x;
                switch (x) {
                    case 0:
                        zukChatMessage("Drag them to the molten deep!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_1, executor);
                        break;
                    case 1:
                        zukChatMessage("Flames unending...");
                        soundEngine.playClip(Sound.ZUK_FIGHT_2, executor);
                        break;
                    case 2:
                        zukChatMessage("Break beneath me!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_3, executor);
                        break;
                    case 3:
                        zukChatMessage("Tremble before me!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_4, executor);
                        break;
                    case 4:
                        zukChatMessage("Suffer!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_5, executor);
                        break;
                    case 5:
                        zukChatMessage("Sear!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_6, executor);
                        break;
                    case 6:
                        zukChatMessage("Burn!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_7, executor);
                        break;
                    case 7:
                        zukChatMessage("Die!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_8, executor);
                        break;
                    case 8:
                        zukChatMessage("Flames consume you!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_9, executor);
                        break;
                    case 9:
                        zukChatMessage("Fall, and burn to ash!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_10, executor);
                        break;
                    case 10:
                        zukChatMessage("Be scourged by flame!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_11, executor);
                        break;
                    case 11:
                        zukChatMessage("Begone!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_12, executor);
                        break;
                    case 12:
                        zukChatMessage("Ful's flame burns within me!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_13, executor);
                        break;
                    case 13:
                        zukChatMessage("Burn to nothing!");
                        soundEngine.playClip(Sound.ZUK_FIGHT_14, executor);
                        break;
                }
                ticksSinceLastQuote = 0;
            }
        }

        if (!isInInfernoArea())
            resetInferno();
        else
            fakeNpcHandler.onGameTick(event);

        if (unpaused && unpauseBuffer == 0 && !isInInfernoArea())
            unpaused = false;

        if (antiSpam > 0)
            antiSpam--;
    }

    public void onNpcSpawned(NpcSpawned event) {
        int npcID = event.getNpc().getId();

        // TzKal-Zuk combat initiated
        if (npcID == 7706) {
            boss = event.getNpc();
            zukFight = true;
            ticksSinceEncounterStart = 0;
            ticksSinceLastQuote = 0;
            switch (random.nextInt(3)) {
                case 0:
                    zukChatMessage("Now - the true battle begins!");
                    boss.setOverheadCycle(250);
                    soundEngine.playClip(Sound.ZUK_START_1, executor);
                    break;
                case 1:
                    zukChatMessage("Out of the way, weaklings!");
                    boss.setOverheadCycle(250);
                    soundEngine.playClip(Sound.ZUK_START_2, executor);
                    break;
                case 2:
                    zukChatMessage("It appears you have exceeded my expectations. Perhaps you are worthy... to fall before my might!");
                    boss.setOverheadCycle(500);
                    soundEngine.playClip(Sound.ZUK_START_3, executor);
                    break;
            }
        }
    }

    public void onActorDeath(ActorDeath event) {
        Actor actor = event.getActor();
        if (actor instanceof Player)
        {
            Player player = (Player) actor;
            if (isInInfernoArea() && player == client.getLocalPlayer())
            {
                switch(random.nextInt(3)) {
                    case 0:
                        zukChatMessage("Pathetic.");
                        soundEngine.playClip(Sound.ZUK_DEFEAT_1, executor);
                        break;
                    case 1:
                        zukChatMessage("Worthless. Just like the rest.");
                        soundEngine.playClip(Sound.ZUK_DEFEAT_2, executor);
                        break;
                    case 2:
                        zukChatMessage("You have failed, as expected.");
                        soundEngine.playClip(Sound.ZUK_DEFEAT_3, executor);
                        break;
                }
                antiSpam = 10;
            }
        }

        if (Objects.equals(actor.getName(), "TzKal-Zuk")) {
            switch(random.nextInt(3)) {
                case 0:
                    zukChatMessage("Impossible...");
                    soundEngine.playClip(Sound.ZUK_VICTORY_1, executor);
                    break;
                case 1:
                    zukChatMessage("Not.. since Bandos...");
                    soundEngine.playClip(Sound.ZUK_VICTORY_2, executor);
                    break;
                case 2:
                    zukChatMessage("Finally... After thousands of years...");
                    soundEngine.playClip(Sound.ZUK_VICTORY_3, executor);
                    break;
            }
            boss.setOverheadCycle(300);
            antiSpam = 10;
        }
    }

    public void onGameStateChanged(GameStateChanged event) {
        if (event.getGameState() == GameState.LOGGING_IN || event.getGameState() == GameState.HOPPING)
            loggingIn = true;

        if (event.getGameState() == GameState.LOGGED_IN && loggingIn) {
            unpaused = true;
            unpauseBuffer = 4;
            loggingIn = false;
            resetInferno();
        }
    }


    public void zukChatMessage(String message) {
        if (fakeZuk != null) {
            fakeNpcHandler.addOverheadText(fakeZuk, "TzKal-Zuk", message);
        }
        else {
            client.addChatMessage(ChatMessageType.PUBLICCHAT, "TzKal-Zuk", message, null);
            if (zukFight && boss != null) {
                boss.setOverheadCycle(150);
                boss.setOverheadText(message);
            }
        }
    }

    public void resetInferno() {
        infernoStart = false;
        zukFight = false;
        lastPhrase = -1;
        messageDelay = -1;
        ticksSinceEncounterStart = -1;
        ticksSinceLastQuote = -1;
    }
}

package com.rs3voiceovers;

import net.runelite.client.config.Config;
import net.runelite.client.config.ConfigGroup;
import net.runelite.client.config.ConfigItem;
import net.runelite.client.config.ConfigSection;

@ConfigGroup("rs3 voiceovers")
public interface RS3VoiceoversConfig extends Config
{

    @ConfigItem(
            position = 0,
            keyName = "voiceoverVolume",
            name = "Voiceover volume",
            description = "Adjust how loud audio voiceovers are played."
    )
    default int voiceoverVolume() {
        return 30;
    }

    @ConfigSection(
            name = "TzKal-Zuk",
            description = "TzKal-Zuk audio settings.",
            position = 1
    )
    String zuk = "zukSection";

    @ConfigItem(
            position = 1,
            keyName = "zuk",
            name = "TzKal-Zuk",
            description = "Adds TzKal-Zuk audio to the Inferno and Jad Challenges.",
            section = zuk
    )
    default boolean zuk() {
        return true;
    }

    @ConfigSection(
            name = "Zemouregal",
            description = "Zemouregal audio settings.",
            position = 2
    )
    String zemouregal = "zemouregalSection";


    @ConfigItem(
            position = 2,
            keyName = "zemouregal",
            name = "Zemouregal and Vorkath",
            description = "Adds Zemouregal (with audio) to the Vorkath encounter.",
            section = zemouregal
    )
    default boolean zemouregal() {
        return true;
    }

    @ConfigSection(
            name = "Amascut",
            description = "Amascut audio settings.",
            position = 4
    )
    String amascut = "amascutSection";

    @ConfigItem(
            position = 4,
            keyName = "amascut",
            name = "Amascut, the Devourer",
            description = "Adds Amascut (with audio) to the Wardens encounter in the Tombs of Amascut.",
            section = amascut
    )
    default boolean amascut() {
        return true;
    }

    @ConfigItem(
            position = 5,
            keyName = "amascutP3",
            name = "Amascut P3 Callout",
            description = "Determines whether Amascut calls out to Crondis/Apmeken or Het/Scabaras in P3.",
            section = amascut
    )
    default AmascutP3 amascutP3() {
        return AmascutP3.ZEBAK_BABA;
    }

    @ConfigSection(
            name = "God Wars Dungeon",
            description = "God Wars Dungeon audio settings.",
            position = 6
    )
    String gwd = "gwdSection";

    @ConfigItem(
            position = 6,
            keyName = "graardor",
            name = "General Graardor",
            description = "Adds audio for General Graardor's overhead text + death.",
            section = gwd
    )
    default boolean graardor() {
        return true;
    }

    @ConfigItem(
            position = 7,
            keyName = "kreearra",
            name = "Kree'arra",
            description = "Adds audio for Kree'arra's overhead text.",
            section = gwd
    )
    default boolean kreearra() {
        return true;
    }

    @ConfigItem(
            position = 8,
            keyName = "kril",
            name = "K'ril Tsutsaroth",
            description = "Adds audio for K'ril Tsutsaroth's overhead text + death.",
            section = gwd
    )
    default boolean kril() {
        return true;
    }

    @ConfigItem(
            position = 9,
            keyName = "zilyana",
            name = "Commander Zilyana",
            description = "Adds audio for Commander Zilyana's overhead text + death.",
            section = gwd
    )
    default boolean zilyana() {
        return true;
    }

    @ConfigItem(
            position = 10,
            keyName = "zilyanaHurt",
            name = "Zilyana hurt noises",
            description = "Adds the noises Commander Zilyana makes in RS3 when she takes damage.",
            section = gwd
    )
    default boolean zilyanaHurt() {
        return false;
    }


}


package com.rs3voiceovers;
import java.awt.*;

import lombok.Getter;
import lombok.Setter;
import net.runelite.api.Client;
import net.runelite.api.Perspective;
import net.runelite.api.Point;
import net.runelite.api.RuneLiteObject;
import net.runelite.api.coords.LocalPoint;
import net.runelite.client.ui.FontManager;
import net.runelite.client.ui.overlay.Overlay;
import net.runelite.client.ui.overlay.OverlayLayer;
import net.runelite.client.ui.overlay.OverlayPosition;

import javax.inject.Inject;

public class RS3VoiceoversOverlay extends Overlay {
    @Inject
    private final Client client;

    @Getter @Setter
    private String overheadText = "";

    @Getter @Setter
    private int maxTextHeightOffset = 0;

    @Getter @Setter
    private int minTextHeightOffset = 0;

    @Getter @Setter
    private RuneLiteObject runeLiteObject;

    public RS3VoiceoversOverlay(Client client) {
        this.client = client;

        setPosition(OverlayPosition.DYNAMIC);
        setLayer(OverlayLayer.ABOVE_SCENE);
    }

    @Override
    public Dimension render(Graphics2D g) {
        if (runeLiteObject == null)
            return null;

        LocalPoint localPoint = runeLiteObject.getLocation();
        if (localPoint == null)
            return null;

        int plane = client.getLocalPlayer().getWorldArea().getPlane();
        int heightOffset = runeLiteObject.getModel().getModelHeight();

        if (heightOffset > maxTextHeightOffset)
            heightOffset = maxTextHeightOffset;
        if (heightOffset < minTextHeightOffset)
            heightOffset = minTextHeightOffset;

        Point canvasPoint = Perspective.localToCanvas(client, localPoint, plane, heightOffset);

        if (canvasPoint == null) {
            return null;
        }

        g.setFont(FontManager.getRunescapeBoldFont());
        FontMetrics fm = g.getFontMetrics();
        int textWidth = fm.stringWidth(overheadText);
        int x = canvasPoint.getX() - textWidth / 2;
        int y = canvasPoint.getY() + 20;

        g.setColor(Color.BLACK);
        g.drawString(overheadText, x + 1, y + 1);
        g.setColor(Color.YELLOW);
        g.drawString(overheadText, x, y);

        return null;
    }
}

package com.rs3voiceovers;

import com.rs3voiceovers.bosses.*;
import com.rs3voiceovers.sound.SoundEngine;
import com.rs3voiceovers.sound.SoundFileManager;

import com.google.inject.Provides;
import javax.inject.Inject;
import java.util.concurrent.ScheduledExecutorService;

import lombok.extern.slf4j.Slf4j;
import net.runelite.api.*;
import net.runelite.api.events.*;
import net.runelite.client.chat.ChatMessageManager;
import net.runelite.client.config.ConfigManager;
import net.runelite.client.eventbus.Subscribe;
import net.runelite.client.eventbus.EventBus;
import net.runelite.client.events.ConfigChanged;
import net.runelite.client.plugins.Plugin;
import net.runelite.client.plugins.PluginDescriptor;
import net.runelite.client.ui.overlay.OverlayManager;
import okhttp3.OkHttpClient;

@Slf4j
@PluginDescriptor(
        name = "RS3 Voiceovers",
        description = "Adds RS3 voiceovers to certain encounters (Inferno, Vorkath, Wardens, GWD).",
        tags = {"rs3", "boss", "runescape 3", "voice", "inferno", "zuk", "tzkal", "vorkath", "toa", "amascut", "gwd"}
)

public class RS3VoiceoversPlugin extends Plugin {
    private final Zemouregal zemouregal = new Zemouregal();
    private final Amascut amascut = new Amascut();
    private final Zuk zuk = new Zuk();
    private final Graardor graardor = new Graardor();
    private final Kreearra kreearra = new Kreearra();
    private final Kril kril = new Kril();
    private final Zilyana zilyana = new Zilyana();

    @Inject
    private SoundEngine soundEngine;
    @Inject
    private ScheduledExecutorService executor;
    @Inject
    private Client client;
    @Inject
    private RS3VoiceoversConfig config;
    @Inject
    private EventBus eventBus;
    @Inject
    private ChatMessageManager chatMessageManager;
    @Inject
    private OkHttpClient okHttpClient;

    @Inject
    private OverlayManager overlayManager;
    private RS3VoiceoversOverlay overlay;

    @Override
    protected void startUp() throws Exception {
        log.debug("RS3 Voiceovers started.");
        overlay = new RS3VoiceoversOverlay(client);

        bossStartup(zuk);
        bossStartup(zemouregal);
        bossStartup(amascut);
        bossStartup(graardor);
        bossStartup(kreearra);
        bossStartup(kril);
        bossStartup(zilyana);

        overlayManager.add(overlay);

        executor.submit(() -> SoundFileManager.prepareSoundFiles(okHttpClient));
    }

    @Override
    protected void shutDown() throws Exception {
        log.debug("RS3 Voiceovers stopped.");
        overlayManager.remove(overlay);
        overlay = null;
    }

    @Subscribe
    public void onChatMessage(ChatMessage event) {
        if (event.getType() != ChatMessageType.GAMEMESSAGE && event.getType() != ChatMessageType.SPAM)
            return;

        if (config.zuk())
            zuk.onChatMessage(event);

        if (config.amascut())
            amascut.onChatMessage(event);
    }

    @Subscribe
    public void onClientTick(ClientTick event) {
        if (config.zuk())
            zuk.onClientTick(event);

        if (config.zemouregal())
            zemouregal.onClientTick(event);

        if (config.amascut())
            amascut.onClientTick(event);
    }

    @Subscribe
    public void onGameTick(GameTick event) {
        if (config.zuk())
            zuk.onGameTick(event);
        else
            zuk.resetInferno();

        if (config.zemouregal())
            zemouregal.onGameTick(event);
        else
            zemouregal.resetVorkath();

        if (config.amascut())
            amascut.onGameTick(event);
        else
            amascut.resetWardens();
    }

    @Subscribe
    public void onNpcChanged(NpcChanged event) {
        if (event.getNpc() == null)
            return;

        if (config.zemouregal())
            zemouregal.onNpcChanged(event);

        if (config.amascut())
            amascut.onNpcChanged(event);
    }

    @Subscribe
    public void onNpcSpawned(NpcSpawned event) {
        if (event.getNpc() == null)
            return;

        if (config.zuk())
            zuk.onNpcSpawned(event);

        if (config.amascut())
            amascut.onNpcSpawned(event);
    }

    @Subscribe
    public void onAnimationChanged(AnimationChanged event) {
        if (event.getActor() == null)
            return;

        if (config.amascut())
            amascut.onAnimationChanged(event);
    }

    @Subscribe
    public void onActorDeath(ActorDeath event)
    {
        if (config.zuk())
            zuk.onActorDeath(event);

        if (config.zemouregal())
            zemouregal.onActorDeath(event);

        if (config.amascut())
            amascut.onActorDeath(event);
    }

    @Subscribe
    public void onHitsplatApplied(HitsplatApplied event) {
        if (config.zemouregal())
            zemouregal.onHitsplatApplied(event);
    }

    @Subscribe
    public void onProjectileMoved(ProjectileMoved event) {
        if (config.amascut())
            amascut.onProjectileMoved(event);
    }

    @Subscribe
    public void onGameStateChanged(GameStateChanged event) {
        if (config.zuk())
            zuk.onGameStateChanged(event);
    }

    @Subscribe
    public void onOverheadTextChanged(OverheadTextChanged event) {
        if (config.graardor())
            graardor.onOverheadTextChanged(event);

        if (config.zilyana())
            zilyana.onOverheadTextChanged(event);

        if (config.kreearra())
            kreearra.onOverheadTextChanged(event);

        if (config.kril())
            kril.onOverheadTextChanged(event);
    }

    @Subscribe
    public void onSoundEffectPlayed(SoundEffectPlayed event) {
        if (config.graardor())
            graardor.onSoundEffectPlayed(event);

        if (config.zilyana())
            zilyana.onSoundEffectPlayed(event);

        if (config.kril())
            kril.onSoundEffectPlayed(event);
    }

    @Subscribe
    public void onConfigChanged(ConfigChanged event) {
        amascut.setTumekenP3(config.amascutP3().toString().equals("Crondis/Apmeken"));

        zilyana.setZilyanaHurt(config.zilyanaHurt());
    }

    @Provides
    RS3VoiceoversConfig provideConfig(ConfigManager configManager) {
		return configManager.getConfig(RS3VoiceoversConfig.class);
	}

    void bossStartup(Boss boss) {
        boss.startUp(client, soundEngine, executor, chatMessageManager, overlay);
    }
}

package com.rs3voiceovers.sound;

import lombok.Getter;

public enum Sound {
    // TzKal-Zuk
    ZUK_FIRST_WAVE_1("TzKal-Zuk_-_A_challenger_approaches....wav"),
    ZUK_FIRST_WAVE_2("TzKal-Zuk_-_What_makes_you_think_you_have_what_it_takes.wav"),
    ZUK_RELOG("TzKal-Zuk_-_Interesting..._you_return.wav"),
    ZUK_WAVES_1("TzKal-Zuk_-_Show_me_you_are_worthy!.wav"),
    ZUK_WAVES_2("TzKal-Zuk_-_Fight,_worm!_Or_crawl_and_die!.wav"),
    ZUK_WAVES_3("TzKal-Zuk_-_To_the_slaughter!.wav"),
    ZUK_WAVES_4("TzKal-Zuk_-_Prove_your_worth.wav"),
    ZUK_WAVES_5("TzKal-Zuk_-_Charge!.wav"),
    ZUK_WAVES_6("TzKal-Zuk_-_Into_the_fray!.wav"),
    ZUK_WAVES_7("TzKal-Zuk_-_The_unworthy_will_burn.wav"),
    ZUK_WAVES_8("TzKal-Zuk_-_All_of_you__attack_.wav"),
    ZUK_WAVES_9("TzKal-Zuk_-_Rise,_scions_of_the_Kiln!.wav"),
    ZUK_WAVES_10("TzKal-Zuk_-_Fight_or_die!.wav"),
    ZUK_WAVES_11("TzKal-Zuk_-_Die,_and_be_reborn_in_flame!.wav"),
    ZUK_WAVES_12("TzKal-Zuk_-_To_ashes_.wav"),
    ZUK_START_1("TzKal-Zuk_-_Now_-_the_true_battle_begins!.wav"),
    ZUK_START_2("TzKal-Zuk_-_Out_of_the_way,_weaklings!.wav"),
    ZUK_START_3("TzKal-Zuk_-_Perhaps_you_are_worthy.wav"),
    ZUK_FIGHT_1("TzKal-Zuk_-_Drag_them_to_the_molten_deep!.wav"),
    ZUK_FIGHT_2("TzKal-Zuk_-_Flames_unending....wav"),
    ZUK_FIGHT_3("TzKal-Zuk_-_Break_beneath_me.wav"),
    ZUK_FIGHT_4("TzKal-Zuk_-_Tremble_before_me.wav"),
    ZUK_FIGHT_5("TzKal-Zuk_-_Suffer_.wav"),
    ZUK_FIGHT_6("TzKal-Zuk_-_Sear_.wav"),
    ZUK_FIGHT_7("TzKal-Zuk_-_Burn!.wav"),
    ZUK_FIGHT_8("TzKal-Zuk_-_Die_.wav"),
    ZUK_FIGHT_9("TzKal-Zuk_-_Flames_consume_you_.wav"),
    ZUK_FIGHT_10("TzKal-Zuk_-_Fall__and_burn_to_ash_.wav"),
    ZUK_FIGHT_11("TzKal-Zuk_-_Be_scourged_by_flame!.wav"),
    ZUK_FIGHT_12("TzKal-Zuk_-_Begone!.wav"),
    ZUK_FIGHT_13("TzKal-Zuk_-_Ful_s_flame_burns_within_me_.wav"),
    ZUK_FIGHT_14("TzKal-Zuk_-_Burn_to_nothing!.wav"),
    ZUK_ENRAGED_1("TzKal-Zuk_-_This_has_gone_on_too_long_-_kill_them!.wav"),
    ZUK_ENRAGED_2("TzKal-Zuk_-_I_grow_weary_of_this._End_it_quickly.wav"),
    ZUK_VICTORY_1("TzKal-Zuk_-_Impossible....wav"),
    ZUK_VICTORY_2("TzKal-Zuk_-_Not..._since_Bandos....wav"),
    ZUK_VICTORY_3("TzKal-Zuk_-_Finally..._After_thousands_of_years....wav"),
    ZUK_DEFEAT_1("TzKal-Zuk_-_Pathetic.wav"),
    ZUK_DEFEAT_2("TzKal-Zuk_-_Worthless._Just_like_the_rest.wav"),
    ZUK_DEFEAT_3("TzKal-Zuk_-_You_have_failed,_as_expected.wav"),
    ZUK_JAD_1("TzKal-Zuk_-_Rise_Jad!.wav"),
    ZUK_JAD_2("TzKal-Zuk_-_Unleash_Jad!.wav"),
    ZUK_JAD_3("TzKal-Zuk_-_Enough._Jad_will_end_this.wav"),
    ZUK_JAD_VICTORY_1("TzKal-Zuk_-_Ungh._not_bad...wav"),
    ZUK_JAD_VICTORY_2("TzKal-Zuk_-_A_champion_rises.wav"),
    ZUK_JAD_VICTORY_3("TzKal-Zuk_-_You_have_earned_your_right_to_live._For_now.wav"),
    ZUK_JAD_VICTORY_4("TzKal-Zuk_-_Hmph._Interesting...wav"),
    ZUK_JAD_VICTORY_5("TzKal-Zuk_-_It_appears_you_have_exceeded_my_expectations.wav"),
    ZUK_JAD_VICTORY_6("TzKal-Zuk_-_Not...so_weak_as_you_seem.wav"),


    // Zemouregal (and Vorkath)
    VORKATH_START_1("Zemouregal_-_Obey_your_master,_you_dumb_puppet.wav"),
    VORKATH_START_2("Zemouregal_-_The_dragon_WILL_be_mine!.wav"),
    VORKATH_START_3("Zemouregal_-_Rise_you_cursed_weakling,_I_shan't_tell_you_again!.wav"),
    VORKATH_COMMON_1("Zemouregal_-_Your_struggle__like_your_life__is_meaningless.wav"),
    VORKATH_COMMON_2("Zemouregal_-_No-one_can_stand_against_my_mighty_Undead!.wav"),
    VORKATH_COMMON_3("Zemouregal_-_No_escape.wav"),
    VORKATH_COMMON_4("Zemouregal_-_You_WILL_yield_to_my_might!.wav"),
    VORKATH_COMMON_5("Zemouregal_-_Be_gone,_gnawing_pest!.wav"),
    VORKATH_COMMON_6("Zemouregal_-_You_will_be_one_with_my_undead_troops.wav"),
    VORKATH_COMMON_7("Zemouregal_-_These_are_your_final_moments,_halfwit!.wav"),
    VORKATH_COMMON_8("Zemouregal_-_I'll_make_a_feast_of_your_blood_and_be_strengthened!.wav"),
    VORKATH_COMMON_9("Zemouregal_-_Why_do_you_bother_to_test_me_.wav"),
    VORKATH_COMMON_10("Zemouregal_-_You_thought_you_were_a_match_for_my_majesty_.wav"),
    VORKATH_COMMON_11("Zemouregal_-_I_shall_rend_the_very_flesh_from_your_bones!.wav"),
    VORKATH_COMMON_12("Zemouregal_-_Pah!_Pitiful.wav"),
    VORKATH_UNCOMMON_1("Zemouregal_-_This_piteous_joke_ends_now.wav"),
    VORKATH_UNCOMMON_2("Zemouregal_-_DIE!.wav"),
    VORKATH_UNCOMMON_3("Zemouregal_-_Say_farewell.wav"),
    VORKATH_UNCOMMON_4("Zemouregal_-_Cut_them_down_without_mercy!.wav"),
    VORKATH_UNCOMMON_5("Zemouregal_-_Cast_my_glorious_vengeance_down_upon_them!.wav"),
    VORKATH_POISON_1("Zemouregal_-_Suffocate_this_land_with_bile!.wav"),
    VORKATH_POISON_2("Zemouregal_-_Spew_your_venom,_my_malformed_pet!.wav"),
    VORKATH_POISON_3("Zemouregal_-_YES,_Heal the dumb beast!.wav"),
    VORKATH_POISON_4("Zemouregal_-_Drown_in_your_own_gore!.wav"),
    VORKATH_VICTORY_1("Zemouregal_-_Bah!_Useless!.wav"),
    VORKATH_VICTORY_2("Zemouregal_-_Are_you_determined_to_fail_.wav"),
    VORKATH_VICTORY_3("Zemouregal_-_GET_UP!_-_Why_must_you_test_my_patience_.wav"),
    VORKATH_VICTORY_4("Zemouregal_-_Urgh,_must_I_be_forever_plagued_by_lesser_beings_.wav"),
    VORKATH_VICTORY_5("Zemouregal_-_Inadequate_failure.wav"),
    VORKATH_DEFEAT_1("Zemouregal_-_Say_hello_to_Death_for_me!.wav"),
    VORKATH_DEFEAT_2("Zemouregal_-_Death_is,_quite_frankly,_too_good_for_you.wav"),
    VORKATH_DEFEAT_3("Zemouregal_-_Finally,_an_end_to_your_meddling.wav"),
    VORKATH_DEFEAT_4("Zemouregal_-_Death_protects_you__I_meant_to_have_you_for_my_own...wav"),
    VORKATH_DEFEAT_5("Zemouregal_-_Your_life_is_payment_for_this_folly!.wav"),

    // Amascut
    AMASCUT_START_1("Amascut_-_Destruction._Annihilation._My_vision_for_this_world.wav"),
    AMASCUT_START_2("Amascut_-_How_close_it_came_to_becoming_a_reality.wav"),
    AMASCUT_START_3("Amascut_-_Picture_the_heroes_who_would_have_risen_against_me.wav"),
    AMASCUT_START_4("Amascut_-_The_challenges_they_would_have_overcome.wav"),
    AMASCUT_START_5("Amascut_-_And_the_rewards_they_would_have_reaped.wav"),
    AMASCUT_START_6("Amascut_-_Who_among_you_is_worthy_of_facing_a_goddess_.wav"),
    AMASCUT_START_7("Amascut_-_Show_me....wav"),
    AMASCUT_TELEPORT_1("Amascut_-_The_mice_fight_back....wav"),
    AMASCUT_TELEPORT_2("Amascut_-_You_dare_to_turn_your_back_on_me_.wav"),
    AMASCUT_OBELISK_1("Amascut_-_Bend_the_knee.wav"),
    AMASCUT_OBELISK_2("Amascut_-_Grovel.wav"),
    AMASCUT_OBELISK_3("Amascut_-_Pathetic.wav"),
    AMASCUT_OBELISK_4("Amascut_-_Weak.wav"),
    AMASCUT_P2_1("Amascut_-_Tear_them_apart.wav"),
    AMASCUT_P2_2("Amascut_-_Even_with_your_strength_combined,_you_cannot_stop_me.wav"),
    AMASCUT_P2_3("Amascut_-_Resourcefulness_will_not_save_you.wav"),
    AMASCUT_P2_4("Amascut_-_I_am_a_god!.wav"),
    AMASCUT_P2_5("Amascut_-_Death_is_the_only_peace.wav"),
    AMASCUT_P2_6("Amascut_-_Your_companions_will_betray_you..._they_always_do.wav"),
    AMASCUT_ARCANE_1("Amascut_-_All_strength_withers.wav"),
    AMASCUT_ARCANE_2("Amascut_-_I_will_not_suffer_this.wav"),
    AMASCUT_ARCANE_3("Amascut_-_Your_soul_is_WEAK.wav"),
    AMASCUT_P2_END_1("Amascut_-_I_will_not_be_denied.wav"),
    AMASCUT_P2_END_2("Amascut_-_I_WILL_NOT_BE_SUBJUGATED_BY_A_MORTAL!.wav"),
    AMASCUT_P2_END_3("Amascut_-_It_is_NOT_over!.wav"),
    AMASCUT_P2_END_4("Amascut_-_ENOUGH.wav"),
    AMASCUT_P2_END_5("Amascut_-_Fall_to_the_shadow.wav"),
    AMASCUT_P2_END_6("Amascut_-_You_are_nothing!.wav"),
    AMASCUT_P2_END_7("Amascut_-_Mwahahaha.wav"),
    AMASCUT_P3_START_1("Amascut_-_Watch_as_this_vision_becomes_reality.wav"),
    AMASCUT_P3_START_2("Amascut_-_Behold!_The_fate_of_this_world.wav"),
    AMASCUT_P3_START_3("Amascut_-_Prove_that_you_have_the_will_to_stand_against_the_vision_of_a_goddess!.wav"),
    AMASCUT_P3_START_4("Amascut_-_I_will_tear_this_world_asunder!.wav"),
    AMASCUT_P3_START_5("Amascut_-_Let_us_see_if_these_delusions_of_grandeur_can_withstand_The_Devourers_maw.wav"),
    AMASCUT_P3_START_6("Amascut_-_Behold_the_inevitable_future!.wav"),
    AMASCUT_P3_MONOLOGUE_1("Amascut_-_It_is_not_merely_my_power_you_face!.wav"),
    AMASCUT_P3_MONOLOGUE_2("Amascut_-_Het...Scabaras...Bear_witness!.wav"),
    AMASCUT_P3_MONOLOGUE_3("Amascut_-_Bring_forth_Crondis_and_Apmeken.wav"),
    AMASCUT_P3_MONOLOGUE_4("Amascut_-_There_can_be_no_light_without_darkness!.wav"),
    AMASCUT_P3_MONOLOGUE_5("Amascut_-_Your_light_will_be_snuffed_out,_once_and_for_all.wav"),
    AMASCUT_P3_MONOLOGUE_6("Amascut_-_Our_father_will_be_reborn!.wav"),
    AMASCUT_P3_MONOLOGUE_7("Amascut_-_His_soul_will_be_judged_and_condemned!.wav"),
    AMASCUT_P3_MONOLOGUE_8("Amascut_-_I_will_have_my_vengeance!.wav"),
    AMASCUT_P3_MONOLOGUE_9("Amascut_-_Tumeken's_heart_I_will_claw_it_out_myself_if_I_have_to.wav"),
    AMASCUT_P3_MONOLOGUE_10("Amascut_-_Was_I_nothing_to_him.wav"),
    AMASCUT_P3_MONOLOGUE_11("Amascut_-_So_be_it....wav"),
    AMASCUT_P3_MONOLOGUE_12("Amascut_-_Come,_mortal.wav"),
    AMASCUT_P3_MONOLOGUE_13("Amascut_-_If_I_cannot_judge_his_soul,_then_I_will_condemn_yours_in_its_place.wav"),
    AMASCUT_P3_MONOLOGUE_14("Amascut_-_I_am_the_one_who_devours.wav"),
    AMASCUT_P3_MONOLOGUE_15("Amascut_-_I_AM.wav"),
    AMASCUT_P3_MONOLOGUE_16("Amascut_-_THE_GOD.wav"),
    AMASCUT_P3_MONOLOGUE_17("Amascut_-_OF.wav"),
    AMASCUT_P3_MONOLOGUE_18("Amascut_-_DESTRUCTION.wav"),
    AMASCUT_P3_MONOLOGUE_19("Amascut_-_DESTRUCTION_2.wav"),
    AMASCUT_P3_MONOLOGUE_20("Amascut_-_DESTRUCTION_3.wav"),
    AMASCUT_VICTORY_1("Amascut_-_Impossible....wav"),
    AMASCUT_VICTORY_2("Amascut_-_This_cannot_be_the_end....wav"),
    AMASCUT_VICTORY_3("Amascut_-_NO!.wav"),
    AMASCUT_DEFEAT_1("Amascut_-_Unworthy!.wav"),
    AMASCUT_DEFEAT_2("Amascut_-_There_is_no_place_1.wav"),
    AMASCUT_DEFEAT_3("Amascut_-_Your_souls_are_mine!.wav"),

    // General Graardor
    GRAARDOR_OVERHEAD_1("Graardor_-_All_glory_to_Bandos.wav"),
    GRAARDOR_OVERHEAD_2("Graardor_-_Brargh!.wav"),
    GRAARDOR_OVERHEAD_3("Graardor_-_Break_their_bones.wav"),
    GRAARDOR_OVERHEAD_4("Graardor_-_CHAAARGE!.wav"),
    GRAARDOR_OVERHEAD_5("Graardor_-_Crush_them_underfoot.wav"),
    GRAARDOR_OVERHEAD_6("Graardor_-_Death_to_our_enemies.wav"),
    GRAARDOR_OVERHEAD_7("Graardor_-_For_the_glory_of_Big_High_War_God.wav"),
    GRAARDOR_OVERHEAD_8("Graardor_-_GRRRAAAAR!.wav"),
    GRAARDOR_OVERHEAD_9("Graardor_-_Split_their_skulls.wav"),
    GRAARDOR_OVERHEAD_10("Graardor_-_We_feast_on_the_bones_of_our_enemies_tonight.wav"),
    GRAARDOR_DEATH_1("Graardor_-_Death_1.wav"),
    GRAARDOR_DEATH_2("Graardor_-_Death_2.wav"),

    // Commander Zilyana
    ZILYANA_OVERHEAD_1("Zilyana_-_All_praise_Saradomin.wav"),
    ZILYANA_OVERHEAD_2("Zilyana_-_Attack!_Find_the_Godsword.wav"),
    ZILYANA_OVERHEAD_3("Zilyana_-_Death_to_the_enemies_of_the_light.wav"),
    ZILYANA_OVERHEAD_4("Zilyana_-_Forward!_Our_allies_are_with_us.wav"),
    ZILYANA_OVERHEAD_5("Zilyana_-_Good_will_always_triumph.wav"),
    ZILYANA_OVERHEAD_6("Zilyana_-_In_the_name_of_Saradomin.wav"),
    ZILYANA_OVERHEAD_7("Zilyana_-_May_Saradomin_be_my_sword.wav"),
    ZILYANA_OVERHEAD_8("Zilyana_-_Saradomin_is_with_us.wav"),
    ZILYANA_OVERHEAD_9("Zilyana_-_Saradomin_lend_me_strength.wav"),
    ZILYANA_OVERHEAD_10("Zilyana_-_Slay_the_evil_ones.wav"),
    ZILYANA_DEATH_1("Zilyana_-_Death_1.wav"),
    ZILYANA_DEATH_2("Zilyana_-_Death_2.wav"),
    ZILYANA_DEATH_3("Zilyana_-_Death_3.wav"),
    ZILYANA_HURT_1("Zilyana_-_Hurt_1.wav"),
    ZILYANA_HURT_2("Zilyana_-_Hurt_2.wav"),
    ZILYANA_HURT_3("Zilyana_-_Hurt_3.wav"),
    ZILYANA_HURT_4("Zilyana_-_Hurt_4.wav"),

    // Kree'arra
    KREEARRA_KRAAW("Kree'arra_-_Kraaaw!.wav"),
    KREEARRA_SKREE("Kree'arra_-_Skreeeee!.wav"),

    // K'ril Tsutsaroth
    KRIL_OVERHEAD_1("K'ril_-_Attack!.wav"),
    KRIL_OVERHEAD_2("K'ril_-_Attack_them_you_dogs.wav"),
    KRIL_OVERHEAD_3("K'ril_-_Death_to_Saradomin's_dogs.wav"),
    KRIL_OVERHEAD_4("K'ril_-_Flay_them_all.wav"),
    KRIL_OVERHEAD_5("K'ril_-_Forward.wav"),
    KRIL_OVERHEAD_6("K'ril_-_Kill_them_you_cowards.wav"),
    KRIL_OVERHEAD_7("K'ril_-_No_retreat.wav"),
    KRIL_OVERHEAD_8("K'ril_-_Rend_them_limb_from_limb.wav"),
    KRIL_OVERHEAD_9("K'ril_-_The_dark_one_will_have_their_souls.wav"),
    KRIL_OVERHEAD_10("K'ril_-_Zamorak_curse_them.wav"),
    KRIL_YARRR("K'ril_-_Yarrr.wav"),
    KRIL_DEATH("K'ril_-_Death.wav"),

    ;

    @Getter
    private final String resourceName;

    Sound(String resNam) {
        resourceName = resNam;
    }

    @Override
    public String toString() {
        return resourceName;
    }
}

package com.rs3voiceovers.sound;

import com.rs3voiceovers.RS3VoiceoversConfig;
import lombok.extern.slf4j.Slf4j;
import net.runelite.client.audio.AudioPlayer;

import javax.inject.Inject;
import javax.inject.Singleton;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.UnsupportedAudioFileException;
import java.io.IOException;
import java.time.Duration;
import java.util.concurrent.Executor;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.TimeUnit;



@Singleton
@Slf4j
public class SoundEngine {

    @Inject
    private RS3VoiceoversConfig config;

    @Inject
    private AudioPlayer audioPlayer;

    public void playClip(Sound sound, Executor executor) {
        executor.execute(() -> playClip(sound));
    }

    public void playClip(Sound sound, ScheduledExecutorService executor, Duration initialDelay) {
        executor.schedule(() -> playClip(sound), initialDelay.toMillis(), TimeUnit.MILLISECONDS);
    }

    private void playClip(Sound sound) {
        float gain = 20f * (float) Math.log10(config.voiceoverVolume()/ 100f);

        try {
            audioPlayer.play(SoundFileManager.getSoundFile(sound), gain);
        } catch (IOException | UnsupportedAudioFileException | LineUnavailableException e) {
            log.warn("Failed to load sound {}", sound, e);
        }
    }
}

package com.rs3voiceovers.sound;

/*
    I got this off of the c engineer completed plugin credit goes to that
 */

import lombok.extern.slf4j.Slf4j;
import net.runelite.client.RuneLite;
import okhttp3.HttpUrl;
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;

import java.io.BufferedInputStream;
import java.io.File;
import java.io.IOException;
import java.nio.file.FileAlreadyExistsException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardCopyOption;
import java.util.Arrays;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import static java.util.function.Predicate.not;

@Slf4j
public class SoundFileManager {
    private SoundFileManager() {}

    private static final Path DOWNLOAD_DIR = Path.of(RuneLite.RUNELITE_DIR.getPath(), "rs3 voiceovers");
    private static final String DELETE_WARNING_FILENAME = "_EXTRA_FILES_WILL_BE_DELETED_BUT_FOLDERS_WILL_REMAIN";
    private static final Path DELETE_WARNING_FILE = DOWNLOAD_DIR.resolve(DELETE_WARNING_FILENAME);

    private static final HttpUrl RAW_GITHUB = HttpUrl.parse("https://raw.githubusercontent.com/ironicmemes/rs3voiceoversounds/main");

    public static File getSoundFile(Sound sound) {
        return DOWNLOAD_DIR.resolve(sound.getResourceName()).toFile();
    }

    public static void prepareSoundFiles(OkHttpClient okHttpClient) {
        ensureDownloadDirectoryExists();
        deleteUndesiredFilesIgnoringFolders();
        downloadNotYetPresentSounds(okHttpClient);
    }

    private static void ensureDownloadDirectoryExists() {
        try {
            if (!Files.exists(DOWNLOAD_DIR))
                Files.createDirectories(DOWNLOAD_DIR);
            Files.createFile(DELETE_WARNING_FILE);
        } catch (FileAlreadyExistsException ignored) {
            /* ignored */
        } catch (IOException e) {
            log.error("RS3 Voiceovers could not create download directory or warning file", e);
        }
    }

    private static void deleteUndesiredFilesIgnoringFolders() {
        Set<String> desiredSoundFileNames = getDesiredSounds()
                .map(Sound::getResourceName)
                .collect(Collectors.toSet());

        Set<Path> toDelete = getFilesPresent().stream()
                .filter(not(desiredSoundFileNames::contains))
                .map(DOWNLOAD_DIR::resolve)
                .collect(Collectors.toSet());
        try {
            for (Path pathToDelete : toDelete) {
                Files.delete(pathToDelete);
            }
        } catch (IOException e) {
            log.error("Failed to delete disused sound files", e);
        }
    }

    private static void downloadNotYetPresentSounds(OkHttpClient okHttpClient) {
        getFilesToDownload()
                .forEach(filename -> downloadFilename(okHttpClient, filename));
    }

    private static void downloadFilename(OkHttpClient okHttpClient, String filename) {
        if (RAW_GITHUB == null) {
            // Hush intellij, it's okay, the potential NPE can't hurt you now
            log.error("RS3 Voiceovers could not download sounds due to an unexpected null RAW_GITHUB value");
            return;
        }
        HttpUrl soundUrl = RAW_GITHUB.newBuilder().addPathSegment(filename).build();
        Request request = new Request.Builder().url(soundUrl).build();
        try (Response res = okHttpClient.newCall(request).execute()) {
            if (res.body() != null)
                Files.copy(new BufferedInputStream(res.body().byteStream()), DOWNLOAD_DIR.resolve(filename), StandardCopyOption.REPLACE_EXISTING);
        } catch (IOException e) {
            log.error("Could not download sounds", e);
        }
    }

    private static Stream<String> getFilesToDownload() {
        Set<String> filesAlreadyPresent = getFilesPresent();

        return getDesiredSounds()
                .map(Sound::getResourceName)
                .filter(not(filesAlreadyPresent::contains));
    }

    private static Set<String> getFilesPresent() {
        try (Stream<Path> paths = Files.list(DOWNLOAD_DIR)) {
            return paths
                    .filter(path -> !Files.isDirectory(path))
                    .map(Path::toFile)
                    .map(File::getName)
                    .filter(filename -> !DELETE_WARNING_FILENAME.equals(filename))
                    .collect(Collectors.toSet());
        } catch (IOException e) {
            log.warn("Could not list files in {}, assuming it to be empty", DOWNLOAD_DIR);
            return Set.of();
        }
    }

    private static Stream<Sound> getDesiredSounds() {
        return Arrays.stream(Sound.values());
    }
}

package com.rs3voiceovers;

import net.runelite.client.RuneLite;
import net.runelite.client.externalplugins.ExternalPluginManager;

public class RS3VoiceoversPluginTest
{
	public static void main(String[] args) throws Exception
	{
		ExternalPluginManager.loadBuiltin(RS3VoiceoversPlugin.class);
		RuneLite.main(args);
	}
}
